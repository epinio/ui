(("undefined"!==typeof self?self:this)["webpackJsonpepinio_1_11_0_1"]=("undefined"!==typeof self?self:this)["webpackJsonpepinio_1_11_0_1"]||[]).push([[2],{"083d":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return!e.value||e.$fetchState.pending?t("Loading"):t("CruResource",{class:e.shouldShowButtons,attrs:{"can-yaml":!1,mode:e.mode,resource:e.value,errors:e.errors,"validation-passed":e.validationPassed},on:{error:t=>e.errors=t,finish:e.save}},[t("ResourceTabs",{attrs:{mode:"mode"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[e.showSourceTab?t("Tab",{attrs:{"label-key":"epinio.applications.steps.source.label",name:"source",weight:30}},[t("div",{staticClass:"wizard-container"},[t("Wizard",{staticClass:"wizard",attrs:{steps:e.steps,"banner-title":e.t("epinio.applications.steps.source.label"),"banner-title-subtext":e.t("epinio.applications.steps.source.subtext"),"header-mode":"edit","finish-mode":"done","edit-first-step":!0},on:{cancel:e.cancel,finish:e.finish},scopedSlots:e._u([{key:"source",fn:function(){return[e.source?t("AppSource",{attrs:{application:e.value,source:e.source,mode:e.mode,info:e.epinioInfo},on:{change:e.updateSource,changeAppInfo:e.updateInfo,changeAppConfig:e.updateManifestConfigurations,valid:function(t){e.steps[0].ready=t}}}):e._e()]},proxy:!0},{key:"progress",fn:function({step:a}){return[t("AppProgress",{attrs:{application:e.value,source:e.source,bindings:e.bindings,mode:e.mode,step:a}})]}}],null,!1,1359924540)})],1)]):e._e(),t("Tab",{attrs:{"label-key":"epinio.applications.steps.basics.label",name:"info",weight:20,error:e.tabErrors.appInfo}},[t("AppInfo",{attrs:{application:e.value,mode:e.mode},on:{change:e.updateInfo,valid:function(t){return e.validate(t,"appInfo")}}})],1),t("Tab",{attrs:{"label-key":"epinio.applications.steps.configurations.label",name:"configurations",weight:10}},[t("AppConfiguration",{attrs:{application:e.value,"initial-application":e.initialValue,mode:e.mode},on:{change:e.updateConfigurations}})],1)],1)],1)},s=[],o=a("8bbf"),n=a.n(o),r=a("305c"),l=a("fd5f"),p=a("c422"),u=a("38de"),c=a("15ca"),d=a("009e"),h=a("a63a"),v=a("84f3"),f=a("ed59"),m=a("0012"),b=a("0fa1"),g=a("da25"),y=a("8c2f"),w=a("90cd"),_=a("a8b9"),A=n.a.extend({components:{AppSource:b["b"],AppProgress:y["a"],Loading:c["a"],CruResource:l["a"],ResourceTabs:p["a"],Tab:u["a"],AppInfo:d["a"],Wizard:f["a"],AppConfiguration:h["a"]},data(){var e;const t=this.value.appSource;var a,i;t.git&&null!==(e=this.$route.query)&&void 0!==e&&e.commit&&(t.git.commit=null===(a=this.$route)||void 0===a||null===(i=a.query)||void 0===i?void 0:i.commit);return{bindings:{configurations:[],services:[]},errors:[],source:t,steps:[{name:"source",label:this.t("epinio.applications.steps.source.label"),subtext:this.t("epinio.applications.steps.source.subtext"),ready:!1,nextButton:{labelKey:"epinio.applications.steps.configurations.update",style:"btn role-primary bg-warning"}},{name:"progress",label:this.t("epinio.applications.steps.progress.label"),subtext:this.t("epinio.applications.steps.progress.subtext"),ready:!1,previousButton:{disable:!0}}],epinioInfo:void 0,tabErrors:{appInfo:!1}}},mixins:[r["a"]],props:{value:{type:Object,required:!0},initialValue:{type:Object,required:!0},mode:{type:String,required:!0}},async fetch(){const e=await Object(_["a"])({ns:this.$store.dispatch("epinio/findAll",{type:w["h"].NAMESPACE}),charts:this.$store.dispatch("epinio/findAll",{type:w["h"].APP_CHARTS}),info:this.$store.dispatch("epinio/info")});this.epinioInfo=e.info},computed:{shouldShowButtons(){return"#source"===this.$route.hash?"hide-buttons-deploy":""},showSourceTab(){return this.mode===g["n"]},validationPassed(){return!Object.values(this.tabErrors).find(e=>e)}},methods:{async save(e){this.errors=[];try{var t,a;await this.value.update(),await this.value.updateConfigurations(this.initialValue.baseConfigurationsNames||[],(null===(t=this.bindings)||void 0===t?void 0:t.configurations)||[]),await this.value.updateServices(this.initialValue.services||[],(null===(a=this.bindings)||void 0===a?void 0:a.services)||[]),await this.value.forceFetch(),this._isBeingDestroyed&&this._isDestroyed||(e(!0),this.done())}catch(i){this.errors=Object(v["a"])(i),e(!1)}},set(e,t){Object.entries(t).forEach(([t,a])=>{n.a.set(e,t,a)})},updateInfo(e){this.value.meta=this.value.meta||{},this.value.configuration=this.value.configuration||{},this.set(this.value.meta,e.meta),this.set(this.value.configuration,e.configuration)},updateConfigurations(e){n.a.set(this,"bindings",e),this.set(this.value.configuration,[...e.configurations])},cancel(){this.$router.replace(this.value.listLocation)},finish(){this.$router.replace(Object(m["a"])("c-cluster-resource-id",{cluster:this.$store.getters["clusterId"],resource:this.value.type,id:`${this.value.meta.namespace}/${this.value.meta.name}`}))},updateSource(e){this.source={};const{appChart:t,...a}=e;this.value.configuration=this.value.configuration||{},t&&this.set(this.value.configuration,{appchart:t}),this.set(this.source,a)},updateManifestConfigurations(e){this.set(this.value.configuration,{configurations:e})},validate(e,t){t&&(this.tabErrors[t]=!e),this.steps[0].ready=e}}}),C=A,x=(a("61a1"),a("6c86"),a("d802")),S=Object(x["a"])(C,i,s,!1,null,"4228732c",null);t["default"]=S.exports},"61a1":function(e,t,a){"use strict";a("d391")},"6c86":function(e,t,a){"use strict";a("e9b3")},c9ad:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return!e.value||e.$fetchState.pending?t("Loading"):e.value?t("CruResource",{attrs:{"min-height":"7em",mode:e.mode,"done-route":e.doneRoute,resource:e.value,"can-yaml":!1,errors:e.errors,"validation-passed":e.validationPassed,"namespace-key":"meta.namespace"},on:{error:t=>e.errors=t,finish:e.save,cancel:e.done}},[e.value.isServiceRelated?t("Banner",{attrs:{color:"info"}},[e._v(" "+e._s(e.t("epinio.configurations.tableHeaders.service.tooltip"))+" ")]):e._e(),t("NameNsDescription",{attrs:{"name-key":"name","namespace-key":"namespace","namespaces-override":e.namespaceNames,"create-namespace-override":!0,"description-hidden":!0,value:e.value.meta,mode:e.mode}}),t("div",{staticClass:"row"},[t("div",{staticClass:"col span-6"},[t("LabeledSelect",{attrs:{loading:e.$fetchState.pending,disabled:e.noApps,options:e.nsAppOptions,searchable:!0,mode:e.mode,multiple:!0,"label-key":"epinio.configurations.bindApps.label",placeholder:e.noApps?e.t("epinio.configurations.bindApps.placeholderNoOptions"):e.t("epinio.configurations.bindApps.placeholderWithOptions")},model:{value:e.selectedApps,callback:function(t){e.selectedApps=t},expression:"selectedApps"}})],1)]),t("div",{staticClass:"spacer"}),t("div",{staticClass:"row"},[t("div",{staticClass:"col span-11"},[t("KeyValue",{attrs:{value:e.value.data,"initial-empty-row":!0,mode:e.mode,title:e.t("epinio.configurations.pairs.label"),"title-protip":e.t("epinio.configurations.pairs.tooltip"),"key-label":e.t("epinio.applications.create.envvar.keyLabel"),"value-label":e.t("epinio.applications.create.envvar.valueLabel"),valueMarkdownMultiline:!0,"parse-lines-from-file":!0,"parse-value-from-file":!0},on:{input:function(t){return e.setData(t)}}})],1)])],1):e._e()},s=[],o=a("8bbf"),n=a.n(o),r=a("305c"),l=a("15ca"),p=a("fd5f"),u=a("3c8c"),c=a("9ce4"),d=a("90cd"),h=a("a232"),v=a("84f3"),f=a("f920"),m=a("1d19"),b=a("466b"),g=a("eb32"),y=a("4b03"),w=n.a.extend({components:{Loading:l["a"],CruResource:p["a"],NameNsDescription:u["a"],KeyValue:h["a"],Banner:g["a"],LabeledSelect:b["a"]},mixins:[r["a"],y["default"]],props:{mode:{type:String,required:!0},value:{type:Object,required:!0},initialValue:{type:Object,required:!0}},async fetch(){var e,t;await this.mixinFetch(),n.a.set(this.value.meta,"namespace",this.initialValue.meta.namespace||(null===(e=this.namespaces[0])||void 0===e?void 0:e.metadata.name)),this.selectedApps=[...(null===(t=this.initialValue.configuration)||void 0===t?void 0:t.boundapps)||[]]},data(){var e;return n.a.set(this.value,"data",{...null===(e=this.initialValue.configuration)||void 0===e?void 0:e.details}),{errors:[],selectedApps:[],validationPassed:!1}},mounted(){this.updateValidation()},computed:{...Object(c["a"])({t:"i18n/t"}),namespaces(){return Object(m["a"])(this.$store.getters["epinio/all"](d["h"].NAMESPACE),"name",!1)},namespaceNames(){return this.namespaces.map(e=>e.metadata.name)}},methods:{async save(e){this.errors=[];try{this.isCreate&&(await this.value.create(),await this.updateConfigurationAppBindings(),await this.$store.dispatch("epinio/findAll",{type:this.value.type,opt:{force:!0}})),this.isEdit&&(await this.value.update(),await this.updateConfigurationAppBindings(),await this.value.forceFetch()),this._isBeingDestroyed&&this._isDestroyed||(e(!0),this.done())}catch(t){this.errors=Object(v["a"])(t),e(!1)}},setData(e){n.a.set(this.value,"data",e)},updateValidation(){var e,t;const a=Object(f["a"])((null===(e=this.value)||void 0===e?void 0:e.meta.name)||"",this.t("epinio.namespace.name"),this.$store.getters,void 0,[]),i=Object(f["a"])((null===(t=this.value)||void 0===t?void 0:t.meta.namespace)||"","",this.$store.getters,void 0,[]);if(0===a.length&&0===i.length){var s;const e=Object.entries((null===(s=this.value)||void 0===s?void 0:s.data)||{});if(e.length)return void n.a.set(this,"validationPassed",!0)}n.a.set(this,"validationPassed",!1)}},watch:{"value.meta.namespace"(){n.a.set(this,"selectedApps",[]),this.updateValidation()},"value.meta.name"(){this.updateValidation()},"value.data":{deep:!0,handler(e){this.updateValidation()}}}}),_=w,A=a("d802"),C=Object(A["a"])(_,i,s,!1,null,null,null);t["default"]=C.exports},d391:function(e,t,a){var i=a("f7b5");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var s=a("0ed3").default;s("5fed68c8",i,!0,{sourceMap:!1,shadowMode:!1})},e351:function(e,t,a){var i=a("5eaa");t=i(!1),t.push([e.i,".hide-buttons-deploy .cru__footer{display:none!important}",""]),e.exports=t},e9b3:function(e,t,a){var i=a("e351");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var s=a("0ed3").default;s("81b9dcb4",i,!0,{sourceMap:!1,shadowMode:!1})},f7b5:function(e,t,a){var i=a("5eaa");t=i(!1),t.push([e.i,".wizard-container[data-v-4228732c]{position:relative;margin-bottom:-20px;margin-right:-20px}.wizard-container .wizard[data-v-4228732c]{position:relative;overflow:auto}.wizard-container .wizard .appSource[data-v-4228732c],.wizard-container .wizard .progress-container[data-v-4228732c]{padding-bottom:75px}",""]),e.exports=t}}]);
//# sourceMappingURL=epinio-1.11.0-1.umd.min.edit.js.map