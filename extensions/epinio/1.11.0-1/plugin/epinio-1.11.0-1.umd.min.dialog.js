(("undefined"!==typeof self?self:this)["webpackJsonpepinio_1_11_0_1"]=("undefined"!==typeof self?self:this)["webpackJsonpepinio_1_11_0_1"]||[]).push([[1],{"059d":function(e,t,a){var s=a("c80a");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var o=a("0ed3").default;o("5066bbfe",s,!0,{sourceMap:!1,shadowMode:!1})},"4cf4":function(e,t,a){var s=a("5eaa");t=s(!1),t.push([e.i,".export-app-dialog__title[data-v-2bf0de9f]{margin-bottom:0}.export-app-dialog__tab[data-v-2bf0de9f]{min-height:110px}.progress-info span[data-v-2bf0de9f]{display:block;margin-bottom:10px}",""]),e.exports=t},7709:function(e,t,a){"use strict";a("cd71")},af72:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("GenericPrompt",e._b({on:{close:e.close}},"GenericPrompt",e.config,!1),[t("h4",{staticClass:"text-default-text login-dialog__title",attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(e.t("epinio.login.modal.title"))+" ")]),t("template",{slot:"body"},[e.cluster.oidcEnabled?t("Tabbed",{on:{changed:e.tabChanged}},[t("Tab",{staticClass:"login-dialog__tab",attrs:{"label-key":"epinio.login.modal.local.tabLabel",name:e.tab.local,weight:3}},[t("form",[t("div",{staticClass:"span-10 offset-1"},[t("div",{staticClass:"mb-20"},[t("LabeledInput",{ref:"username",attrs:{id:"username","data-testid":"local-login-username",label:e.t("login.username"),autocomplete:"epinio-username",required:!0},model:{value:e.username,callback:function(t){e.username="string"===typeof t?t.trim():t},expression:"username"}})],1),t("div",{},[t("Password",{ref:"password",attrs:{id:"password","data-testid":"local-login-password",label:e.t("login.password"),autocomplete:"epinio-password",required:!0},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)])])]),t("Tab",{staticClass:"login-dialog__tab",attrs:{"label-key":"epinio.login.modal.dex.tabLabel",name:e.tab.dex,weight:2}},[t("p",[e._v(" "+e._s(e.t("epinio.login.modal.dex.prompt"))+" ")])])],1):t("form",[t("div",{staticClass:"span-10 offset-1 mt-15"},[t("div",{staticClass:"mb-20"},[t("LabeledInput",{ref:"username",attrs:{id:"username","data-testid":"local-login-username",label:e.t("login.username"),autocomplete:"epinio-username",required:!0},model:{value:e.username,callback:function(t){e.username="string"===typeof t?t.trim():t},expression:"username"}})],1),t("div",{},[t("Password",{ref:"password",attrs:{id:"password","data-testid":"local-login-password",label:e.t("login.password"),autocomplete:"epinio-password",required:!0},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)])])],1)],2)},o=[],r=a("1c22"),i=a("0cb2"),n=a("38de"),l=a("4d8c"),c=a("6b77"),p=a("8e93"),d={name:"LoginDialog",components:{GenericPrompt:r["a"],Tabbed:i["a"],Tab:n["a"],LabeledInput:p["a"],Password:c["a"]},props:{resources:{type:Array,required:!0}},data(){return{selectedTab:"",username:"",password:"",config:{applyMode:"login",applyAction:this.login},tab:{local:"local",dex:"dex"}}},computed:{cluster(){return this.resources[0]}},mounted(){this.cluster.oidcEnabled||(this.selectedTab=this.tab.local)},methods:{async login(){const e=[];switch(this.selectedTab){case this.tab.local:if(this.username||e.push("Username"),this.password||e.push("Password"),e.length)return Promise.reject(new Error(e.join("/")+" Required"));await l["b"].login(this.cluster.createAuthConfig(l["a"].LOCAL,{username:this.username,password:this.password,$axios:this.$axios}));break;case this.tab.dex:await l["b"].login(this.cluster.createAuthConfig(l["a"].DEX));break;default:throw new Error("Unknown log in type: "+this.selectedTab)}this.cluster.loggedIn=!0,this.$router.push({name:"epinio-c-cluster-dashboard",params:{cluster:this.cluster.id}})},tabChanged({selectedName:e}){this.selectedTab=e},close(){this.$emit("close",!1)}}},u=d,h=(a("e461"),a("d802")),m=Object(h["a"])(u,s,o,!1,null,"618c76cc",null);t["default"]=m.exports},c80a:function(e,t,a){var s=a("5eaa");t=s(!1),t.push([e.i,".login-dialog__title[data-v-618c76cc]{margin-bottom:0}.login-dialog__tab[data-v-618c76cc]{min-height:145px}",""]),e.exports=t},c840:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("GenericPrompt",e._b({ref:"genericPrompt",on:{close:e.close}},"GenericPrompt",e.config,!1),[t("h4",{staticClass:"text-default-text export-app-dialog__title",attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(e.t("epinio.applications.export.label"))+" ")]),t("template",{slot:"body"},[t("Tabbed",{on:{changed:e.resetErrors}},[t("Tab",{staticClass:"export-app-dialog__tab",attrs:{"label-key":"epinio.applications.export.manifest.title",name:"manifest",weight:3}},[t("p",[e._v(" "+e._s(e.t("epinio.applications.export.manifest.description"))+" ")])]),t("Tab",{staticClass:"export-app-dialog__tab",attrs:{"label-key":"epinio.applications.export.chartValuesImages.title",name:"chart",weight:2}},[t("p",[e._v(" "+e._s(e.t("epinio.applications.export.chartValuesImages.description"))+" ")]),t("Banner",{attrs:{color:"info"}},[e._v(" "+e._s(e.t("epinio.applications.export.chartValuesImages.banner"))+" ")]),e.showProgressBar?t("div",{staticClass:"progress-info text info mb-10 mt-20"},[e.step?t("span",[e._v(" "+e._s(e.t("epinio.applications.export.chartValuesImages.steps."+e.step))+" ")]):e._e(),t("PercentageBar",{staticClass:"progress-bar",attrs:{value:e.progressBar,"color-stops":e.colorStops,"preferred-direction":"MORE"}})],1):e._e()],1)],1)],1)],2)},o=[],r=a("8bbf"),i=a.n(r),n=a("1c22"),l=a("eb32"),c=a("0cb2"),p=a("38de"),d=a("5877"),u=a.n(d),h=a("c87d"),m=a("ea72"),g=a("90cd");const b={[g["c"].VALUES]:.1,[g["c"].CHART]:.1,[g["c"].IMAGE]:.7};var f={name:"ExportAppDialog",components:{GenericPrompt:n["a"],Banner:l["a"],PercentageBar:m["a"],Tabbed:c["a"],Tab:p["a"]},props:{resources:{type:Array,required:!0}},data(){return{config:{title:this.t("promptRemove.title"),applyMode:"export",applyAction:this.exportApplicationManifest},zipParts:this.resources[0].applicationParts.filter(e=>e!==g["c"].MANIFEST),showProgressBar:!1,percentages:{},step:null,cancelTokenSources:{},colorStops:{0:"--primary",100:"--primary"}}},mounted(){document.addEventListener("keyup",this.escapeHandler)},beforeDestroy(){document.removeEventListener("keyup",this.escapeHandler)},computed:{progressBar:{get(){return Object.keys(this.percentages).reduce((e,t)=>e+this.percentages[t]*(b[t]||1),0)},set(e){this.percentages={value:e}}}},methods:{async exportApplicationManifest(){this.enableDownload();const e=this.resources[0],t=async t=>{const a=new u.a;for(const e in t){const s={[g["c"].VALUES]:"yaml",[g["c"].CHART]:"tar.gz",[g["c"].IMAGE]:"tar"};a.file(`${e}.${s[e]}`,t[e])}const s=await a.generateAsync({type:"blob",compression:"STORE"});await Object(h["a"])(e.meta.name+"-helm-chart.zip",s,"application/zip")};if("#manifest"===this.$route.hash)await e.createManifest();else{const a=await this.zipParts.reduce(async(t,a)=>({...await t,[a]:await this.fetchPart(e,a)}),Promise.resolve({}));if(Object.values(a).some(e=>!e))return;this.toggleStep("zip"),await t(a),this.progressBar=100,await this.delayBeforeClose(1500)}},getCancelToken(){return this.$store.$axios.CancelToken},async fetchPart(e,t){return this.toggleStep(t,!0),this.cancelTokenSources[t]=this.getCancelToken().source(),await e.fetchPart(t,{onDownloadProgress:e=>{const a=e.srcElement.getResponseHeader("content-length")||e.srcElement.getResponseHeader("proxy-content-length");a&&i.a.set(this.percentages,t,Math.round(100*e.loaded/a)),e.loaded>0&&this.toggleStep(t)},cancelToken:this.cancelTokenSources[t].token}).catch(e=>{if(!this.$store.$axios.isCancel(e)){var a;this.disableDownload();const s=null!==(a=e.message)&&void 0!==a?a:this.t("epinio.applications.export.chartValuesImages.error",{part:t});throw new Error(s)}})},fetchCancel(){Object.keys(this.cancelTokenSources).forEach(e=>this.cancelTokenSources[e].cancel(e+" part: download cancelled."))},close(){"#manifest"!==this.$route.hash&&this.fetchCancel(),this.$emit("close")},escapeHandler(e){"Escape"===e.key&&this.close()},resetErrors(){this.$refs.genericPrompt&&(this.$refs.genericPrompt.errors=[])},enableDownload(){this.resetErrors(),this.showProgressBar=!0},disableDownload(){this.fetchCancel(),this.showProgressBar=!1,this.progressBar=0,this.toggleStep(null)},async delayBeforeClose(e){return await new Promise(t=>setTimeout(t,e))},toggleStep(e,t=!1){this.step=e?`${t?"preparing":"download"}.${e}`:null}}},w=f,_=(a("7709"),a("d802")),x=Object(_["a"])(w,s,o,!1,null,"2bf0de9f",null);t["default"]=x.exports},cd71:function(e,t,a){var s=a("4cf4");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var o=a("0ed3").default;o("3a2f453e",s,!0,{sourceMap:!1,shadowMode:!1})},e461:function(e,t,a){"use strict";a("059d")}}]);
//# sourceMappingURL=epinio-1.11.0-1.umd.min.dialog.js.map