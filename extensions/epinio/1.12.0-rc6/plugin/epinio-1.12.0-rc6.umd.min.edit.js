(("undefined"!==typeof self?self:this)["webpackChunkepinio_1_12_0_rc6"]=("undefined"!==typeof self?self:this)["webpackChunkepinio_1_12_0_rc6"]||[]).push([[739],{18885:function(e,a,t){var o=t(52357);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=t(74825).A;n("2f0121c4",o,!0,{sourceMap:!1,shadowMode:!1})},21056:function(e,a,t){"use strict";t.r(a);var o=t(36758),n=t.n(o),i=t(40935),l=t.n(i),r=l()(n());r.push([e.id,".as-text-area{width:100%!important}.value-container .file-selector{margin-bottom:20px}",""]),a["default"]=r},33831:function(e,a,t){var o=t(59847);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=t(74825).A;n("1d5ac6ec",o,!0,{sourceMap:!1,shadowMode:!1})},36212:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return C}});var o=t(9274),n=t(65359),i=t(9492),l=t(40775),r=t(49584),u=t(84409),s=t(84419),c=t(25209),p=t(43970),d=t(66386),v=t(17340),m=t(74209),f=t(42939),g=t(55787),h=t(32766),b=t(88339),y=t(14220);const w={class:"wizard-container"};var k=(0,o.defineComponent)({__name:"applications",props:{value:{},initialValue:{},mode:{}},setup(e){const a=e,{doneParams:t,doneRoute:k}=(0,d.useEpinioBindAppsMixin)(a),A=(0,n.Pj)(),_=A.getters["i18n/t"],C=(0,o.reactive)({configurations:[],services:[]}),V=(0,o.ref)(a.value.appSource),x=(0,o.ref)([]),N=(0,o.ref)(),B=(0,o.reactive)({appInfo:!1}),E=(0,o.reactive)([{name:"source",label:_("epinio.applications.steps.source.label"),subtext:_("epinio.applications.steps.source.subtext"),ready:!1,nextButton:{labelKey:"epinio.applications.steps.configurations.update",style:"btn role-primary bg-warning"}},{name:"progress",label:_("epinio.applications.steps.progress.label"),subtext:_("epinio.applications.steps.progress.subtext"),ready:!1,previousButton:{disable:!0}}]);V.value.git&&A.$router.currentRoute._value.query?.commit&&(V.value.git.commit=A.$router.currentRoute._value.query.commit),(0,o.onMounted)((async()=>{const e=await(0,b.kR)({ns:A.dispatch("epinio/findAll",{type:h.F6.NAMESPACE}),charts:A.dispatch("epinio/findAll",{type:h.F6.APP_CHARTS}),info:A.dispatch("epinio/info")});N.value=e.info}));const M=(0,o.computed)((()=>"#source"===A.$router.currentRoute.value.hash?"hide-buttons-deploy":"")),z=(0,o.computed)((()=>a.mode===y.G5)),F=(0,o.computed)((()=>!Object.values(B).find((e=>e)))),R=()=>{k&&A.$router.replace({name:k.value,params:t.value||{resource:a.value.type}})};async function $(e){x.value=[];try{await a.value.update(),await a.value.updateConfigurations(a.initialValue.baseConfigurationsNames||[],C.configurations||[]),await a.value.updateServices(a.initialValue.services||[],C.services||[]),await a.value.forceFetch(),e(!0),R()}catch(t){x.value=(0,p.L)(t),e(!1)}}function P(e,a){Object.entries(a).forEach((([a,t])=>{e[a]=t}))}function S(e){a.value.meta=a.value.meta||{},a.value.configuration=a.value.configuration||{},P(a.value.meta,e.meta),P(a.value.configuration,e.configuration)}function L(e){Object.assign(C,e)}function O(){A.$router.replace(a.value.listLocation)}function j(){A.$router.replace((0,m.g)("c-cluster-resource-id",{cluster:A.getters["clusterId"],resource:a.value.type,id:`${a.value.meta.namespace}/${a.value.meta.name}`}))}function I(e){V.value={};const{appChart:t,...o}=e;a.value.configuration=a.value.configuration||{},t&&P(a.value.configuration,{appchart:t}),P(V.value,o)}function U(e){P(a.value.configuration,{configurations:e})}function q(e,a){a&&(B[a]=!e),E[0].ready=e}return(e,a)=>e.value?((0,o.openBlock)(),(0,o.createBlock)(i.A,{key:1,class:(0,o.normalizeClass)(M.value),"can-yaml":!1,mode:e.mode,resource:e.value,errors:x.value,"validation-passed":F.value,onError:a[2]||(a[2]=e=>x.value=(0,o.unref)(p.L)(e)),onFinish:$},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(l.A,{mode:"mode"},{default:(0,o.withCtx)((()=>[z.value?((0,o.openBlock)(),(0,o.createBlock)(r.A,{key:0,"label-key":"epinio.applications.steps.source.label",name:"source",weight:30},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",w,[(0,o.createVNode)(v.A,{class:"wizard",steps:E,"banner-title":(0,o.unref)(_)("epinio.applications.steps.source.label"),"banner-title-subtext":(0,o.unref)(_)("epinio.applications.steps.source.subtext"),"header-mode":"edit","finish-mode":"done","edit-first-step":!0,onCancel:O,onFinish:j},{source:(0,o.withCtx)((()=>[V.value?((0,o.openBlock)(),(0,o.createBlock)(f.A,{key:0,application:e.value,source:V.value,mode:e.mode,info:N.value,onChange:I,onChangeAppInfo:S,onChangeAppConfig:U,onValid:a[0]||(a[0]=e=>E[0].ready=e)},null,8,["application","source","mode","info"])):(0,o.createCommentVNode)("",!0)])),progress:(0,o.withCtx)((({step:a})=>[(0,o.createVNode)(g.A,{application:e.value,source:V.value,bindings:C,mode:e.mode,step:a},null,8,["application","source","bindings","mode","step"])])),_:1},8,["steps","banner-title","banner-title-subtext"])])])),_:1})):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(r.A,{"label-key":"epinio.applications.steps.basics.label",name:"info",weight:20,error:B.appInfo},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(s.A,{application:e.value,mode:e.mode,onChange:S,onValid:a[1]||(a[1]=e=>q(e,"appInfo"))},null,8,["application","mode"])])),_:1},8,["error"]),(0,o.createVNode)(r.A,{"label-key":"epinio.applications.steps.configurations.label",name:"configurations",weight:10},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c.A,{application:e.value,"initial-application":e.initialValue,mode:e.mode,onChange:L},null,8,["application","initial-application","mode"])])),_:1})])),_:1})])),_:1},8,["class","mode","resource","errors","validation-passed"])):((0,o.openBlock)(),(0,o.createBlock)(u.A,{key:0}))}}),A=(t(33831),t(18885),t(47433));const _=(0,A.A)(k,[["__scopeId","data-v-5e753384"]]);var C=_},52357:function(e,a,t){"use strict";t.r(a);var o=t(36758),n=t.n(o),i=t(40935),l=t.n(i),r=l()(n());r.push([e.id,".hide-buttons-deploy .cru__footer{display:none!important}",""]),a["default"]=r},56856:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return V}});var o=t(9274),n=t(65359),i=t(66386),l=t(43970),r=t(32766),u=t(74302),s=t(14220),c=t(84409),p=t(53701),d=t(38094),v=t(9492),m=t(40089),f=t(18875),g=t(23242),h=t(4364);const b={key:1},y={class:"row"},w={class:"col span-6"},k={class:"row"},A={class:"col span-11"};var _=(0,o.defineComponent)({__name:"configurations",props:{value:{},initialValue:{},mode:{}},setup(e){const a=(0,n.Pj)(),t=a.getters["i18n/t"],_=e,{doneParams:C,doneRoute:V,selectedApps:x,nsAppOptions:N,noApps:B,updateConfigurationAppBindings:E}=(0,i.useEpinioBindAppsMixin)(_),M=(0,o.ref)([]),z=(0,o.ref)(!0),F=(0,o.ref)(!1);(0,o.onMounted)((async()=>{_.value.meta.namespace=_.initialValue.meta.namespace||$.value[0]?.metadata.name,_.value.data={..._.initialValue.configuration?.details},x.value=[..._.initialValue.configuration?.boundapps||[]],O(),z.value=!1}));const R=(0,o.computed)((()=>_.mode===s.G5)),$=(0,o.computed)((()=>(0,u.Ul)(a.getters["epinio/all"](r.F6.NAMESPACE),"name",!1))),P=(0,o.computed)((()=>$.value.map((e=>e.metadata.name)))),S=()=>{V&&a.$router.replace({name:V.value,params:C.value||{resource:_.value.type}})},L=async e=>{M.value=[];try{R.value||(await _.value.create(),await E(),await a.dispatch("epinio/findAll",{type:_.value.type,opt:{force:!0}})),R.value&&(await _.value.update(),await E(),await _.value.forceFetch()),e(!0),S()}catch(t){h.log(t),M.value=(0,l.L)(t),e(!1)}},O=()=>{const e=(0,g.o)(_.value?.meta.name||"",t("epinio.namespace.name"),a.getters,void 0,[]),o=(0,g.o)(_.value?.meta.namespace||"","",a.getters,void 0,[]);if(0===e.length&&0===o.length){const e=Object.entries(_.value?.data||{});if(e.length)return void(F.value=!0)}F.value=!1};return(0,o.watch)((()=>_.value.meta.namespace),(()=>{x.value=[],O()})),(0,o.watch)((()=>_.value.meta.name),(()=>{O()})),(0,o.watch)((()=>_.value.data),(()=>{O()}),{deep:!0}),(e,a)=>!e.value||z.value?((0,o.openBlock)(),(0,o.createBlock)(c.A,{key:0})):e.value?((0,o.openBlock)(),(0,o.createBlock)(v.A,{key:1,"min-height":"7em",mode:e.mode,"done-route":(0,o.unref)(V),resource:e.value,"can-yaml":!1,errors:M.value,"validation-passed":F.value,"namespace-key":"meta.namespace",onError:a[2]||(a[2]=e=>M.value=e),onFinish:L},{default:(0,o.withCtx)((()=>[e.value.isServiceRelated?((0,o.openBlock)(),(0,o.createBlock)(p.A,{key:0,color:"info"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)((0,o.unref)(t)("epinio.configurations.tableHeaders.service.tooltip")),1)])),_:1})):(0,o.createCommentVNode)("",!0),M.value.length>0?((0,o.openBlock)(),(0,o.createElementBlock)("div",b,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(M.value,((e,a)=>((0,o.openBlock)(),(0,o.createBlock)(p.A,{key:a,color:"error",label:e},null,8,["label"])))),128))])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(f.A,{"name-key":"name","namespace-key":"namespace","namespaces-override":P.value,"create-namespace-override":!0,"description-hidden":!0,value:e.value.meta,mode:e.mode},null,8,["namespaces-override","value","mode"]),(0,o.createElementVNode)("div",y,[(0,o.createElementVNode)("div",w,[(0,o.createVNode)(m.A,{value:(0,o.unref)(x),"onUpdate:value":a[0]||(a[0]=e=>(0,o.isRef)(x)?x.value=e:null),loading:z.value,disabled:(0,o.unref)(B),options:(0,o.unref)(N),searchable:!0,mode:e.mode,multiple:!0,"label-key":"epinio.configurations.bindApps.label",placeholder:(0,o.unref)(B)?(0,o.unref)(t)("epinio.configurations.bindApps.placeholderNoOptions"):(0,o.unref)(t)("epinio.configurations.bindApps.placeholderWithOptions")},null,8,["value","loading","disabled","options","mode","placeholder"])])]),a[3]||(a[3]=(0,o.createElementVNode)("div",{class:"spacer"},null,-1)),(0,o.createElementVNode)("div",k,[(0,o.createElementVNode)("div",A,[(0,o.createVNode)(d.A,{value:e.value.data,"onUpdate:value":a[1]||(a[1]=a=>e.value.data=a),"initial-empty-row":!0,mode:e.mode,title:(0,o.unref)(t)("epinio.configurations.pairs.label"),"title-protip":(0,o.unref)(t)("epinio.configurations.pairs.tooltip"),"key-label":(0,o.unref)(t)("epinio.applications.create.envvar.keyLabel"),"value-label":(0,o.unref)(t)("epinio.applications.create.envvar.valueLabel"),valueMarkdownMultiline:!0,"parse-lines-from-file":!0,"parse-value-from-file":!0},null,8,["value","mode","title","title-protip","key-label","value-label"])])])])),_:1,__:[3]},8,["mode","done-route","resource","errors","validation-passed"])):(0,o.createCommentVNode)("",!0)}});t(68832);const C=_;var V=C},59847:function(e,a,t){"use strict";t.r(a);var o=t(36758),n=t.n(o),i=t(40935),l=t.n(i),r=l()(n());r.push([e.id,".wizard-container[data-v-5e753384]{position:relative;margin-bottom:-20px;margin-right:-20px}.wizard-container .wizard[data-v-5e753384]{position:relative;overflow:auto}.wizard-container .wizard .appSource[data-v-5e753384],.wizard-container .wizard .progress-container[data-v-5e753384]{padding-bottom:75px}",""]),a["default"]=r},68832:function(e,a,t){var o=t(21056);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=t(74825).A;n("6d4c70e6",o,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=epinio-1.12.0-rc6.umd.min.edit.js.map