(("undefined"!==typeof self?self:this)["webpackChunkepinio_1_13_2_rc6"]=("undefined"!==typeof self?self:this)["webpackChunkepinio_1_13_2_rc6"]||[]).push([[907],{10154:function(e,t,a){var o=a(30698);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var l=a(74825).A;l("6996c0eb",o,!0,{sourceMap:!1,shadowMode:!1})},30698:function(e,t,a){"use strict";a.r(t);var o=a(36758),l=a.n(o),n=a(40935),r=a.n(n),i=r()(l());i.push([e.id,".export-app-dialog__title[data-v-06c89c66]{margin-bottom:0}.export-app-dialog__tab[data-v-06c89c66]{min-height:110px}.progress-info span[data-v-06c89c66]{display:block;margin-bottom:10px}",""]),t["default"]=i},48011:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return b}});var o=a(9274),l=a(65359),n=a(47008),r=a.n(n),i=a(32766),s=a(68745),c=a(42411),u=a(6198),p=a(26837),d=a(63209),m=a(12243);const v={class:"text-default-text export-app-dialog__title"},f={key:0,class:"progress-info text info mb-10 mt-20"},g={key:0};var y=(0,o.defineComponent)({__name:"ExportAppDialog",props:{resources:{}},emits:["close"],setup(e,{emit:t}){const a=(0,l.Pj)(),n=a.getters["i18n/t"],y=t,h=e,k=(0,o.ref)(!1),b=(0,o.ref)({}),E=(0,o.ref)(null),w={},x={0:"--primary",100:"--primary"},C=(0,o.ref)(null),_={[i.yc.VALUES]:.1,[i.yc.CHART]:.1,[i.yc.IMAGE]:.7},A=h.resources[0]?.applicationParts.filter(e=>e!==i.yc.MANIFEST);(0,o.onMounted)(()=>{document.addEventListener("keyup",O)}),(0,o.onBeforeUnmount)(()=>{setTimeout(()=>{document.removeEventListener("keyup",O)},2e3)});const V=(0,o.computed)({get(){return Object.keys(b.value).reduce((e,t)=>e+b.value[t]*(_[t]||1),0)},set(e){b.value={value:e}}},{immediate:!0}),N=async()=>{S();const e=h.resources[0],t=async t=>{const a=new(r());for(const e in t){const o={[i.yc.VALUES]:"yaml",[i.yc.CHART]:"tar.gz",[i.yc.IMAGE]:"tar"};a.file(`${e}.${o[e]}`,t[e])}const o=await a.generateAsync({type:"blob",compression:"STORE"});await(0,u.PE)(`${e.meta.name}-helm-chart.zip`,o,"application/zip")};if("#manifest"===a.$router.currentRoute._value.hash)await e.createManifest();else{const a=await A.reduce(async(t,a)=>({...await t,[a]:await D(e,a)}),Promise.resolve({}));if(Object.values(a).some(e=>!e))return;R("zip"),await t(a),V.value=100,await I(1500)}},L={title:n("promptRemove.title"),applyMode:"export",applyAction:N},B=()=>a.$axios.CancelToken,D=async(e,t)=>(R(t,!0),w[t]=B().source(),await e.fetchPart(t,{onDownloadProgress:e=>{const a=e.event.srcElement.getResponseHeader("content-length")||e.event.srcElement.getResponseHeader("proxy-content-length");a&&(b.value[t]=Math.round(100*e.loaded/a)),e.loaded>0&&R(t)},cancelToken:w[t].token}).catch(e=>{if(!a.$axios.isCancel(e)){var o;z();const a=null!==(o=e.message)&&void 0!==o?o:n("epinio.applications.export.chartValuesImages.error",{part:t});throw new Error(a)}})),M=()=>{Object.keys(w).forEach(e=>w[e].cancel(`${e} part: download cancelled.`))},$=()=>{"#manifest"!==a.$router.currentRoute._value.hash&&M(),y("close")},O=e=>{"Escape"===e.key&&$()},P=()=>{C.value&&(C.value.errors=[])},S=()=>{P(),k.value=!0},z=()=>{M(),k.value=!1,V.value=0,R(null)},I=async e=>await new Promise(t=>setTimeout(t,e)),R=(e,t=!1)=>{E.value=e?`${t?"preparing":"download"}.${e}`:null};return(e,t)=>((0,o.openBlock)(),(0,o.createBlock)((0,o.unref)(p.A),(0,o.mergeProps)({ref_key:"genericPrompt",ref:C},L,{onClose:$}),{title:(0,o.withCtx)(()=>[(0,o.createElementVNode)("h4",v,(0,o.toDisplayString)((0,o.unref)(n)("epinio.applications.export.label")),1)]),body:(0,o.withCtx)(()=>[(0,o.createVNode)(d.A,{onChanged:P},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(c.A,{"label-key":"epinio.applications.export.manifest.title",name:"manifest",weight:3,class:"export-app-dialog__tab"},{default:(0,o.withCtx)(()=>[(0,o.createElementVNode)("p",null,(0,o.toDisplayString)((0,o.unref)(n)("epinio.applications.export.manifest.description")),1)]),_:1}),(0,o.createVNode)(c.A,{"label-key":"epinio.applications.export.chartValuesImages.title",name:"chart",weight:2,class:"export-app-dialog__tab"},{default:(0,o.withCtx)(()=>[(0,o.createElementVNode)("p",null,(0,o.toDisplayString)((0,o.unref)(n)("epinio.applications.export.chartValuesImages.description")),1),(0,o.createVNode)(s.A,{color:"info"},{default:(0,o.withCtx)(()=>[(0,o.createTextVNode)((0,o.toDisplayString)((0,o.unref)(n)("epinio.applications.export.chartValuesImages.banner")),1)]),_:1}),k.value?((0,o.openBlock)(),(0,o.createElementBlock)("div",f,[E.value?((0,o.openBlock)(),(0,o.createElementBlock)("span",g,(0,o.toDisplayString)((0,o.unref)(n)(`epinio.applications.export.chartValuesImages.steps.${E.value}`)),1)):(0,o.createCommentVNode)("",!0),(0,o.createVNode)((0,o.unref)(m.A),{class:"progress-bar",modelValue:V.value,"color-stops":x,"preferred-direction":"MORE"},null,8,["modelValue"])])):(0,o.createCommentVNode)("",!0)]),_:1})]),_:1})]),_:1},16))}}),h=(a(10154),a(47433));const k=(0,h.A)(y,[["__scopeId","data-v-06c89c66"]]);var b=k},49403:function(e,t,a){var o=a(89883);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var l=a(74825).A;l("5a5d999e",o,!0,{sourceMap:!1,shadowMode:!1})},60638:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return w}});var o=a(9274),l=a(63816),n=a(65359),r=a(73947),i=a(99726),s=a(9980),c=a(7274),u=a(79380);const p={class:"login-dialog"},d={key:0},m={key:1},v={key:2,class:"local"},f={class:"mb-20"},g={class:"mb-20"},y={key:3,class:"mt-20 text-center"},h={key:4,class:"mt-20 text-center"};var k=(0,o.defineComponent)({__name:"LoginDialog",props:{cluster:{}},emits:["close"],setup(e,{emit:t}){const a=(0,n.Pj)(),k=t,b=e,E={LOCAL:"local",DEX:"dex"},w=(0,o.ref)(""),x=(0,o.ref)(""),C=(0,o.ref)(""),_=(0,o.ref)(!1);let A,V=[];(0,o.onMounted)(()=>{b.cluster.oidcEnabled?C.value=E.DEX:C.value=E.LOCAL});const N=e=>{V=[],C.value=e},L=async e=>{_.value=!0,V=[];try{switch(e){case E.LOCAL:if(w.value||V.push(new Error("Username")),x.value||V.push(new Error("Password")),V.length)throw new Error(`${V.join("/")} Required`);await r.A.login(b.cluster.createAuthConfig(r.w.LOCAL,{username:w.value,password:x.value,$axios:l.A}));break;case E.DEX:await r.A.login(b.cluster.createAuthConfig(r.w.DEX));break;default:throw new Error(`Unknown log in type: ${A}`)}b.cluster.loggedIn=!0,k("close"),a.$router.push({name:"epinio-c-cluster-dashboard",params:{cluster:b.cluster.id}})}catch(t){V.push(...(0,i.rz)(t))}_.value=!1};return(e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",p,[(0,o.unref)(V).length?((0,o.openBlock)(),(0,o.createElementBlock)("div",d,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(V),(e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:t},[(0,o.createVNode)((0,o.unref)(s.l),{color:"error",label:(0,o.unref)(i.As)(e.Message||e)},null,8,["label"])]))),128))])):(0,o.createCommentVNode)("",!0),C.value==E.DEX?((0,o.openBlock)(),(0,o.createElementBlock)("div",m,[(0,o.createElementVNode)("button",{ref:"btn",class:(0,o.normalizeClass)([{disabled:_.value},"btn bg-primary"]),style:{"font-size":"18px"},onClick:t[0]||(t[0]=e=>!_.value&&L(E.DEX))},(0,o.toDisplayString)(e.t("epinio.login.genericProvider")),3)])):(0,o.createCommentVNode)("",!0),C.value===E.LOCAL?((0,o.openBlock)(),(0,o.createElementBlock)("div",v,[(0,o.createElementVNode)("form",null,[(0,o.createElementVNode)("div",f,[(0,o.createVNode)((0,o.unref)(u.o),{id:"username",value:w.value,"onUpdate:value":t[1]||(t[1]=e=>w.value=e),label:e.t("login.username"),required:!0},null,8,["value","label"])]),(0,o.createElementVNode)("div",g,[(0,o.createVNode)((0,o.unref)(c.A),{id:"password",value:x.value,"onUpdate:value":t[2]||(t[2]=e=>x.value=e),label:e.t("login.password"),required:!0},null,8,["value","label"])])]),(0,o.createElementVNode)("button",{ref:"btn",class:(0,o.normalizeClass)(["btn bg-primary",{disabled:_.value}]),style:{"font-size":"18px"},onClick:t[3]||(t[3]=e=>!_.value&&L(E.LOCAL))},(0,o.toDisplayString)(e.t(e.cluster.oidcEnabled?"login.loginWithLocal":"epinio.login.login")),3)])):(0,o.createCommentVNode)("",!0),C.value===E.DEX?((0,o.openBlock)(),(0,o.createElementBlock)("div",y,[(0,o.createElementVNode)("a",{class:(0,o.normalizeClass)({disabled:_.value}),role:"button",onClick:t[4]||(t[4]=e=>!_.value&&N(E.LOCAL))},(0,o.toDisplayString)(e.t("login.useLocal")),3)])):(0,o.createCommentVNode)("",!0),e.cluster.oidcEnabled&&C.value===E.LOCAL?((0,o.openBlock)(),(0,o.createElementBlock)("div",h,[(0,o.createElementVNode)("a",{class:(0,o.normalizeClass)({disabled:_.value}),role:"button",onClick:t[5]||(t[5]=e=>!_.value&&N(E.DEX))},(0,o.toDisplayString)(e.t("epinio.login.useGenericProvider",{})),3)])):(0,o.createCommentVNode)("",!0)]))}}),b=(a(49403),a(47433));const E=(0,b.A)(k,[["__scopeId","data-v-30e141e7"]]);var w=E},89883:function(e,t,a){"use strict";a.r(t);var o=a(36758),l=a.n(o),n=a(40935),r=a.n(n),i=r()(l());i.push([e.id,".login-dialog[data-v-30e141e7]{padding:20px;display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:240px}.login-dialog .banner[data-v-30e141e7]{min-width:400px}.login-dialog .local[data-v-30e141e7]{display:flex;flex-direction:column;align-items:center}.login-dialog .local .labeled-input[data-v-30e141e7],.login-dialog .local .password[data-v-30e141e7]{min-width:400px}",""]),t["default"]=i}}]);
//# sourceMappingURL=epinio-1.13.2-rc6.umd.min.dialog.js.map