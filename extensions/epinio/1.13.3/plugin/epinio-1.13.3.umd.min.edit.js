(("undefined"!==typeof self?self:this)["webpackChunkepinio_1_13_3"]=("undefined"!==typeof self?self:this)["webpackChunkepinio_1_13_3"]||[]).push([[739],{14245:function(e,a,t){"use strict";t.r(a);var o=t(36758),n=t.n(o),i=t(40935),l=t.n(i),r=l()(n());r.push([e.id,".hide-buttons-deploy .cru__footer{display:none!important}",""]),a["default"]=r},36923:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return x}});var o=t(9274),n=t(65359),i=t(66386),l=t(62),r=t(43970),u=t(32766),s=t(74302),c=t(14220),p=t(87619),d=t(68745),v=t(38094),m=t(9492),f=t(28623),g=t(40527),h=t(23242),b=t(4364);const y={key:1},w={class:"row"},k={class:"col span-6"},A={class:"row"},C={class:"col span-11"};var _=(0,o.defineComponent)({__name:"configurations",props:{value:{},initialValue:{},mode:{}},setup(e){const a=(0,n.Pj)(),t=a.getters["i18n/t"],_=e,{doneParams:V,doneRoute:x,selectedApps:N,nsAppOptions:B,noApps:M,updateConfigurationAppBindings:E}=(0,i.useEpinioBindAppsMixin)(_),{setUnsavedChanges:z}=(0,l.useUnsavedChangesMixin)(),F=(0,o.ref)([]),R=(0,o.ref)(!0),$=(0,o.ref)(!1);(0,o.onMounted)(async()=>{_.value.meta.namespace=_.initialValue.meta.namespace||S.value[0]?.metadata.name,_.value.data={..._.initialValue.configuration?.details},N.value=[..._.initialValue.configuration?.boundapps||[]],j(),R.value=!1}),(0,o.watch)([()=>_.value,N],()=>{z(!0)},{deep:!0});const P=(0,o.computed)(()=>_.mode===c.G5),S=(0,o.computed)(()=>(0,s.Ul)(a.getters["epinio/all"](u.F6.NAMESPACE),"name",!1)),L=(0,o.computed)(()=>S.value.map(e=>e.metadata.name)),O=()=>{x&&a.$router.replace({name:x.value,params:V.value||{resource:_.value.type}})},U=async e=>{F.value=[];try{P.value||(await _.value.create(),await E(),await a.dispatch("epinio/findAll",{type:_.value.type,opt:{force:!0}})),P.value&&(await _.value.update(),await E(),await _.value.forceFetch()),z(!1),e(!0),O()}catch(t){b.log(t),F.value=(0,r.L)(t),e(!1)}},j=()=>{const e=(0,h.o)(_.value?.meta.name||"",t("epinio.namespace.name"),a.getters,void 0,[]),o=(0,h.o)(_.value?.meta.namespace||"","",a.getters,void 0,[]);if(0===e.length&&0===o.length){const e=Object.entries(_.value?.data||{});if(e.length)return void($.value=!0)}$.value=!1};return(0,o.watch)(()=>_.value.meta.namespace,()=>{N.value=[],j()}),(0,o.watch)(()=>_.value.meta.name,()=>{j()}),(0,o.watch)(()=>_.value.data,()=>{j()},{deep:!0}),(e,a)=>!e.value||R.value?((0,o.openBlock)(),(0,o.createBlock)(p.A,{key:0})):e.value?((0,o.openBlock)(),(0,o.createBlock)(m.A,{key:1,"min-height":"7em",mode:e.mode,"done-route":(0,o.unref)(x),resource:e.value,"can-yaml":!1,errors:F.value,"validation-passed":$.value,"namespace-key":"meta.namespace",onError:a[2]||(a[2]=e=>F.value=e),onFinish:U},{default:(0,o.withCtx)(()=>[e.value.isServiceRelated?((0,o.openBlock)(),(0,o.createBlock)(d.A,{key:0,color:"info"},{default:(0,o.withCtx)(()=>[(0,o.createTextVNode)((0,o.toDisplayString)((0,o.unref)(t)("epinio.configurations.tableHeaders.service.tooltip")),1)]),_:1})):(0,o.createCommentVNode)("",!0),F.value.length>0?((0,o.openBlock)(),(0,o.createElementBlock)("div",y,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(F.value,(e,a)=>((0,o.openBlock)(),(0,o.createBlock)(d.A,{key:a,color:"error",label:e},null,8,["label"]))),128))])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(g.A,{"name-key":"name","namespace-key":"namespace","namespaces-override":L.value,"create-namespace-override":!0,"description-hidden":!0,value:e.value.meta,mode:e.mode},null,8,["namespaces-override","value","mode"]),(0,o.createElementVNode)("div",w,[(0,o.createElementVNode)("div",k,[(0,o.createVNode)(f.A,{value:(0,o.unref)(N),"onUpdate:value":a[0]||(a[0]=e=>(0,o.isRef)(N)?N.value=e:null),loading:R.value,disabled:(0,o.unref)(M),options:(0,o.unref)(B),searchable:!0,mode:e.mode,multiple:!0,"label-key":"epinio.configurations.bindApps.label",placeholder:(0,o.unref)(M)?(0,o.unref)(t)("epinio.configurations.bindApps.placeholderNoOptions"):(0,o.unref)(t)("epinio.configurations.bindApps.placeholderWithOptions")},null,8,["value","loading","disabled","options","mode","placeholder"])])]),a[3]||(a[3]=(0,o.createElementVNode)("div",{class:"spacer"},null,-1)),(0,o.createElementVNode)("div",A,[(0,o.createElementVNode)("div",C,[(0,o.createVNode)(v.A,{value:e.value.data,"onUpdate:value":a[1]||(a[1]=a=>e.value.data=a),"initial-empty-row":!0,mode:e.mode,title:(0,o.unref)(t)("epinio.configurations.pairs.label"),"title-protip":(0,o.unref)(t)("epinio.configurations.pairs.tooltip"),"key-label":(0,o.unref)(t)("epinio.applications.create.envvar.keyLabel"),"value-label":(0,o.unref)(t)("epinio.applications.create.envvar.valueLabel"),valueMarkdownMultiline:!0,"parse-lines-from-file":!0,"parse-value-from-file":!0},null,8,["value","mode","title","title-protip","key-label","value-label"])])])]),_:1,__:[3]},8,["mode","done-route","resource","errors","validation-passed"])):(0,o.createCommentVNode)("",!0)}});t(71361);const V=_;var x=V},55252:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return V}});var o=t(9274),n=t(65359),i=t(9492),l=t(20938),r=t(42411),u=t(87619),s=t(84419),c=t(25209),p=t(43970),d=t(66386),v=t(62),m=t(17340),f=t(74209),g=t(69890),h=t(55787),b=t(32766),y=t(88339),w=t(14220);const k={class:"wizard-container"};var A=(0,o.defineComponent)({__name:"applications",props:{value:{},initialValue:{},mode:{}},setup(e){const a=e,{doneParams:t,doneRoute:A}=(0,d.useEpinioBindAppsMixin)(a),{setUnsavedChanges:C}=(0,v.useUnsavedChangesMixin)(),_=(0,n.Pj)(),V=_.getters["i18n/t"],x=(0,o.reactive)({configurations:[],services:[]}),N=(0,o.ref)(a.value.appSource),B=(0,o.ref)([]),M=(0,o.ref)(),E=(0,o.reactive)({appInfo:!1}),z=(0,o.reactive)([{name:"source",label:V("epinio.applications.steps.source.label"),subtext:V("epinio.applications.steps.source.subtext"),ready:!1,nextButton:{labelKey:"epinio.applications.steps.configurations.update",style:"btn role-primary bg-warning"}},{name:"progress",label:V("epinio.applications.steps.progress.label"),subtext:V("epinio.applications.steps.progress.subtext"),ready:!1,previousButton:{disable:!0}}]);N.value.git&&_.$router.currentRoute._value.query?.commit&&(N.value.git.commit=_.$router.currentRoute._value.query.commit),(0,o.onMounted)(async()=>{const e=await(0,y.kR)({ns:_.dispatch("epinio/findAll",{type:b.F6.NAMESPACE}),charts:_.dispatch("epinio/findAll",{type:b.F6.APP_CHARTS}),info:_.dispatch("epinio/info")});M.value=e.info}),(0,o.watch)([x,N],()=>{C(!0)},{deep:!0});const F=(0,o.computed)(()=>"#source"===_.$router.currentRoute.value.hash?"hide-buttons-deploy":""),R=(0,o.computed)(()=>a.mode===w.G5),$=(0,o.computed)(()=>!Object.values(E).find(e=>e)),P=()=>{A&&_.$router.replace({name:A.value,params:t.value||{resource:a.value.type}})};async function S(e){B.value=[];try{await a.value.update(),await a.value.updateConfigurations(a.initialValue.baseConfigurationsNames||[],x.configurations||[]),await a.value.updateServices(a.initialValue.services||[],x.services||[]),await a.value.forceFetch(),C(!1),e(!0),P()}catch(t){B.value=(0,p.L)(t),e(!1)}}function L(e,a){Object.entries(a).forEach(([a,t])=>{e[a]=t})}function O(e){a.value.meta=a.value.meta||{},a.value.configuration=a.value.configuration||{},L(a.value.meta,e.meta),L(a.value.configuration,e.configuration)}function U(e){Object.assign(x,e)}function j(){_.$router.replace(a.value.listLocation)}function I(){_.$router.replace((0,f.g)("c-cluster-resource-id",{cluster:_.getters["clusterId"],resource:a.value.type,id:`${a.value.meta.namespace}/${a.value.meta.name}`}))}function q(e){N.value={};const{appChart:t,...o}=e;a.value.configuration=a.value.configuration||{},t&&L(a.value.configuration,{appchart:t}),L(N.value,o)}function G(e){L(a.value.configuration,{configurations:e})}function H(e,a){a&&(E[a]=!e),z[0].ready=e}return(e,a)=>e.value?((0,o.openBlock)(),(0,o.createBlock)(i.A,{key:1,class:(0,o.normalizeClass)(F.value),"can-yaml":!1,mode:e.mode,resource:e.value,errors:B.value,"validation-passed":$.value,onError:a[2]||(a[2]=e=>B.value=(0,o.unref)(p.L)(e)),onFinish:S},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(l.A,{mode:"mode"},{default:(0,o.withCtx)(()=>[R.value?((0,o.openBlock)(),(0,o.createBlock)(r.A,{key:0,"label-key":"epinio.applications.steps.source.label",name:"source",weight:30},{default:(0,o.withCtx)(()=>[(0,o.createElementVNode)("div",k,[(0,o.createVNode)(m.A,{class:"wizard",steps:z,"banner-title":(0,o.unref)(V)("epinio.applications.steps.source.label"),"banner-title-subtext":(0,o.unref)(V)("epinio.applications.steps.source.subtext"),"header-mode":"edit","finish-mode":"done","edit-first-step":!0,onCancel:j,onFinish:I},{source:(0,o.withCtx)(()=>[N.value?((0,o.openBlock)(),(0,o.createBlock)(g.A,{key:0,application:e.value,source:N.value,mode:e.mode,info:M.value,onChange:q,onChangeAppInfo:O,onChangeAppConfig:G,onValid:a[0]||(a[0]=e=>z[0].ready=e)},null,8,["application","source","mode","info"])):(0,o.createCommentVNode)("",!0)]),progress:(0,o.withCtx)(({step:a})=>[(0,o.createVNode)(h.A,{application:e.value,source:N.value,bindings:x,mode:e.mode,step:a},null,8,["application","source","bindings","mode","step"])]),_:1},8,["steps","banner-title","banner-title-subtext"])])]),_:1})):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(r.A,{"label-key":"epinio.applications.steps.basics.label",name:"info",weight:20,error:E.appInfo},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(s.A,{application:e.value,mode:e.mode,onChange:O,onValid:a[1]||(a[1]=e=>H(e,"appInfo"))},null,8,["application","mode"])]),_:1},8,["error"]),(0,o.createVNode)(r.A,{"label-key":"epinio.applications.steps.configurations.label",name:"configurations",weight:10},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(c.A,{application:e.value,"initial-application":e.initialValue,mode:e.mode,onChange:U},null,8,["application","initial-application","mode"])]),_:1})]),_:1})]),_:1},8,["class","mode","resource","errors","validation-passed"])):((0,o.openBlock)(),(0,o.createBlock)(u.A,{key:0}))}}),C=(t(60239),t(62437),t(47433));const _=(0,C.A)(A,[["__scopeId","data-v-187e0c31"]]);var V=_},59137:function(e,a,t){"use strict";t.r(a);var o=t(36758),n=t.n(o),i=t(40935),l=t.n(i),r=l()(n());r.push([e.id,".as-text-area{width:100%!important}.value-container .file-selector{margin-bottom:20px}",""]),a["default"]=r},60239:function(e,a,t){var o=t(94191);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=t(74825).A;n("3fec1564",o,!0,{sourceMap:!1,shadowMode:!1})},62437:function(e,a,t){var o=t(14245);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=t(74825).A;n("69fa643c",o,!0,{sourceMap:!1,shadowMode:!1})},71361:function(e,a,t){var o=t(59137);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=t(74825).A;n("fd2fd2e4",o,!0,{sourceMap:!1,shadowMode:!1})},94191:function(e,a,t){"use strict";t.r(a);var o=t(36758),n=t.n(o),i=t(40935),l=t.n(i),r=l()(n());r.push([e.id,".wizard-container[data-v-187e0c31]{position:relative;margin-bottom:-20px;margin-right:-20px}.wizard-container .wizard[data-v-187e0c31]{position:relative;overflow:auto}.wizard-container .wizard .appSource[data-v-187e0c31],.wizard-container .wizard .progress-container[data-v-187e0c31]{padding-bottom:75px}",""]),a["default"]=r}}]);
//# sourceMappingURL=epinio-1.13.3.umd.min.edit.js.map