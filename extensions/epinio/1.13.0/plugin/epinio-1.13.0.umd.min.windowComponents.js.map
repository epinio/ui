{"version":3,"file":"epinio-1.13.0.umd.min.windowComponents.js","mappings":"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","sources":["webpack://epinio-1.13.0/./windowComponents/ApplicationShell.vue?b1f5","webpack://epinio-1.13.0/./windowComponents/ApplicationLogs.vue?23f9","webpack://epinio-1.13.0/./windowComponents/ApplicationLogs.vue?1013","webpack://epinio-1.13.0/./windowComponents/ApplicationShell.vue?dfef","webpack://epinio-1.13.0/./windowComponents/ApplicationShell.vue","webpack://epinio-1.13.0/./windowComponents/ApplicationShell.vue?28c4","webpack://epinio-1.13.0/./windowComponents/ApplicationShell.vue?1049","webpack://epinio-1.13.0/./windowComponents/ApplicationLogs.vue?2df7","webpack://epinio-1.13.0/./windowComponents/ApplicationLogs.vue","webpack://epinio-1.13.0/./windowComponents/ApplicationLogs.vue?6cc3","webpack://epinio-1.13.0/./windowComponents/ApplicationSocketMixin.ts","webpack://epinio-1.13.0/./windowComponents/ApplicationLogs.vue?817c","webpack://epinio-1.13.0/./windowComponents/ApplicationLogs.vue?728b","webpack://epinio-1.13.0/./windowComponents/ApplicationShell.vue?9104","webpack://epinio-1.13.0/./windowComponents/ApplicationShell.vue?17f3"],"sourcesContent":["// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-23.use[1]!../../../node_modules/vue-loader/dist/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[3]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-23.use[4]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[1]!./ApplicationShell.vue?vue&type=style&index=0&id=7bc331ac&lang=scss\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"931703e8\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".title-inner[data-v-66118bd8],.title-inner-left[data-v-66118bd8],.title-inner-right[data-v-66118bd8]{display:flex;flex-direction:row}.logs-container[data-v-66118bd8]{height:100%;overflow:auto;padding:5px;background-color:var(--logs-bg);font-family:Menlo,Consolas,monospace;color:var(--logs-text)}.logs-container .closed[data-v-66118bd8]{opacity:.25}.logs-container .time[data-v-66118bd8]{white-space:nowrap;display:none;width:0;padding-right:15px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.logs-container.show-times .time[data-v-66118bd8]{display:initial;width:auto}.logs-container .msg[data-v-66118bd8]{white-space:nowrap}.logs-container .msg .highlight[data-v-66118bd8]{color:var(--logs-highlight);background-color:var(--logs-highlight-bg)}.logs-container.wrap-lines .msg[data-v-66118bd8]{white-space:normal}[data-v-66118bd8] .containerPicker.unlabeled-select{display:inline-block;min-width:200px;height:30px;min-height:30px;width:auto}.log-action button[data-v-66118bd8]{border:0!important;min-height:30px;line-height:30px}.log-action>input[data-v-66118bd8],.status[data-v-66118bd8]{height:30px}.status[data-v-66118bd8]{align-items:center;display:flex;min-width:80px}.filter-popup[data-v-66118bd8]>*{margin-bottom:10px}.title-left[data-v-66118bd8]{display:flex}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-23.use[1]!../../../node_modules/vue-loader/dist/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[3]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-23.use[4]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[1]!./ApplicationLogs.vue?vue&type=style&index=0&id=66118bd8&lang=scss\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"24ea3166\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createElementBlock as _createElementBlock, resolveDirective as _resolveDirective, withDirectives as _withDirectives, resolveComponent as _resolveComponent, createVNode as _createVNode, normalizeClass as _normalizeClass, withCtx as _withCtx } from \"vue\"\n\nconst _hoisted_1 = { class: \"pull-left ml-5\" }\nconst _hoisted_2 = { class: \"status pull-left\" }\nconst _hoisted_3 = {\n  key: 0,\n  class: \"text-success\"\n}\nconst _hoisted_4 = {\n  key: 1,\n  class: \"text-warning\"\n}\nconst _hoisted_5 = {\n  key: 2,\n  class: \"text-error\"\n}\n\nimport { useStore } from 'vuex';\nimport { \n  ref, \n  onMounted, \n  onBeforeUnmount, \n  watch,\n  PropType,\n} from 'vue';\n\nimport Socket, {\n  EVENT_CONNECTED,\n  EVENT_CONNECTING,\n  EVENT_DISCONNECTED,\n  EVENT_MESSAGE,\n  EVENT_CONNECT_ERROR,\n} from '@shell/utils/socket';\nimport { allHash } from '@shell/utils/promise';\nimport { addParams } from '@shell/utils/url';\nimport { base64Decode, base64Encode } from '@shell/utils/crypto';\nimport { useApplicationSocketMixin } from './ApplicationSocketMixin';\n\nimport Select from '@shell/components/form/Select';\nimport Window from '@shell/components/nav/WindowManager/Window';\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'ApplicationShell',\n  props: {\n  application: {\n    type: Object as PropType<object>,\n    default: null,\n  },\n  endpoint: {\n    type: String as PropType<string>,\n    default: '',\n  },\n  initialInstance: {\n    type: String,\n    default: null,\n  },\n},\n  setup(__props) {\n\nconst store = useStore();\nconst t = store.getters['i18n/t'];\n\nconst props = __props;\n\nconst {\n  socket,\n  isOpen,\n  backlog,\n  instanceChoices,\n  getRootSocketUrl,\n} = useApplicationSocketMixin(props);\n\nconst active = ref<boolean>(true);\nconst xterm = ref<HTMLElement | null>(null);\nconst instance = ref<string>(props.initialInstance || instanceChoices.value[0]);\nconst terminal = ref<object | null>(null);\nconst fitAddon = ref<object | null>(null);\nconst searchAddon = ref<object | null>(null);\nconst webglAddon = ref<object | null>(null);\nconst isOpening = ref<boolean>(false);\nconst keepAliveTimer = ref<object | null>(null);\nconst xtermConfig = {\n  allowProposedApi: true,\n  cursorBlink:      true,\n  useStyle:         true,\n  fontSize:         12,\n};\n\nwatch(\n  () => instance.value,\n  () => {\n    connect();\n  }\n);\n\nonBeforeUnmount(() => {\n  clearInterval(keepAliveTimer.value);\n  cleanup();\n});\n\nonMounted(async () => {\n  await setupTerminal();\n  await connect();\n\n  isOpen.value = true;\n\n  clearInterval(keepAliveTimer.value);\n  keepAliveTimer.value = setInterval(() => {\n    fit();\n  }, 60 * 1000);\n}); \n\nconst setupTerminal = async () => {\n  const docStyle = getComputedStyle(document.querySelector('body'));\n  const xtermLib = await import('xterm');\n\n  const addons = await allHash({\n    fit:      import('xterm-addon-fit'),\n    webgl:    import('xterm-addon-webgl'),\n    weblinks: import('xterm-addon-web-links'),\n    search:   import('xterm-addon-search'),\n  });\n\n  const terminalTemp = new xtermLib.Terminal({\n    theme: {\n      background: docStyle.getPropertyValue('--terminal-bg').trim(),\n      foreground: docStyle.getPropertyValue('--terminal-text').trim(),\n      cursor: docStyle.getPropertyValue('--terminal-cursor').trim(),\n      selectionBackground: docStyle.getPropertyValue('--terminal-selection').trim(),\n    },\n    ...xtermConfig,\n  });\n\n  fitAddon.value = new addons.fit.FitAddon();\n  searchAddon.value = new addons.search.SearchAddon();\n\n  try {\n    webglAddon.value = new addons.webgl.WebGlAddon();\n  } catch (e: any) { // eslint-disable-line @typescript-eslint/no-unused-vars\n    // Some browsers (Safari) don't support the webgl renderer, so don't use it.\n    webglAddon.value = null;\n  }\n\n  terminalTemp.loadAddon(fitAddon.value);\n  terminalTemp.loadAddon(searchAddon.value);\n  terminalTemp.loadAddon(new addons.weblinks.WebLinksAddon());\n  if (webglAddon.value) {\n    terminalTemp.loadAddon(webglAddon.value);\n  }\n  \n  terminalTemp.open(xterm.value);\n\n  fit();\n  flush();\n\n  terminalTemp.onData((input) => {\n    const msg = `0${ base64Encode(input) }`;\n\n    write(msg);\n  });\n\n  terminal.value = terminalTemp;\n};\n\nconst write = (msg) => {\n  if (isOpen.value) {\n    socket.value.send(msg);\n  } else {\n    backlog.value.push(msg);\n  }\n};\n\nconst clear = () => {\n  terminal.value.clear();\n};\n\nconst getSocketUrl = async () => {\n  const { url, token } = await getRootSocketUrl();\n\n  return addParams(url, {\n    authtoken: token,\n    instance: instance.value,\n  });\n};\n\nconst connect = async () => {\n  if (socket.value) {\n    await socket.value.disconnect();\n    socket.value = null;\n    terminal.value.reset();\n  }\n\n  const url = await getSocketUrl();\n\n  if (!url) {\n    return;\n  }\n\n  socket.value = new Socket(url, false, 0, 'base64.channel.k8s.io');\n\n  socket.value.addEventListener(EVENT_CONNECTING, () => {\n    isOpen.value = false;\n    isOpening.value = true;\n  });\n\n  socket.value.addEventListener(EVENT_CONNECT_ERROR, (e) => {\n    isOpen.value = false;\n    isOpening.value = false;\n    console.error('Connect Error', e);\n  });\n\n  socket.value.addEventListener(EVENT_CONNECTED, () => {\n    isOpen.value = true;\n    isOpening.value = false;\n    fit();\n    flush();\n  });\n\n  socket.value.addEventListener(EVENT_DISCONNECTED, () => {\n    isOpen.value = false;\n    isOpening.value = false;\n  });\n\n  socket.value.addEventListener(EVENT_MESSAGE, (e) => {\n    const type = e.detail.data.substr(0, 1);\n    const msg = base64Decode(e.detail.data.substr(1));\n\n    if (`${ type }` === '1') {\n      terminal.value.write(msg);\n    } else {\n      console.error(msg);\n    }\n  });\n\n  socket.value.connect();\n  terminal.value.focus();\n};\n\nconst flush = () => {\n  const backlogTemp = backlog.value.slice();\n\n  backlog.value = [];\n\n  for (const data of backlogTemp) {\n    socket.value.send(data);\n  }\n};\n\nconst fit = () => {\n  if (!fitAddon.value) {\n    return;\n  }\n  \n  fitAddon.value.fit();\n  const { rows, cols } = fitAddon.value.proposeDimensions();\n\n  if (!isOpen.value) {\n    return;\n  }\n\n  const message = `4${ base64Encode(\n    JSON.stringify({\n      Width:  Math.floor(cols),\n      Height: Math.floor(rows),\n    })\n  ) }`;\n\n  socket.value.send(message);\n};\n\nconst cleanup = () => {\n  if (socket.value) {\n    socket.value.disconnect();\n    socket.value = null;\n  }\n\n  if (terminal.value) {\n    terminal.value.dispose();\n    terminal.value = null;\n  }\n};\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_resize_observer = _resolveComponent(\"resize-observer\")!\n  const _directive_clean_html = _resolveDirective(\"clean-html\")!\n\n  return (_openBlock(), _createBlock(_unref(Window), {\n    active: active.value,\n    \"before-close\": cleanup,\n    class: \"epinio-app-shell\"\n  }, {\n    title: _withCtx(() => [\n      (_unref(instanceChoices).length > 1)\n        ? (_openBlock(), _createBlock(_unref(Select), {\n            key: 0,\n            value: instance.value,\n            \"onUpdate:value\": _cache[0] || (_cache[0] = ($event: any) => ((instance).value = $event)),\n            disabled: _unref(instanceChoices).length === 1,\n            class: \"containerPicker auto-width pull-left\",\n            options: _unref(instanceChoices),\n            clearable: false,\n            placement: \"top\"\n          }, null, 8, [\"value\", \"disabled\", \"options\"]))\n        : _createCommentVNode(\"\", true),\n      _createElementVNode(\"div\", _hoisted_1, [\n        _createElementVNode(\"button\", {\n          class: \"btn btn-sm bg-primary\",\n          onClick: clear\n        }, _toDisplayString(_unref(t)('wm.containerShell.clear')), 1)\n      ]),\n      _createElementVNode(\"div\", _hoisted_2, [\n        (_unref(isOpen))\n          ? (_openBlock(), _createElementBlock(\"span\", _hoisted_3, _toDisplayString(_unref(t)('wm.connection.connected')), 1))\n          : (isOpening.value)\n            ? _withDirectives((_openBlock(), _createElementBlock(\"span\", _hoisted_4, null, 512)), [\n                [_directive_clean_html, _unref(t)('wm.connection.connecting')]\n              ])\n            : (_openBlock(), _createElementBlock(\"span\", _hoisted_5, _toDisplayString(_unref(t)('wm.connection.disconnected')), 1))\n      ])\n    ]),\n    body: _withCtx(() => [\n      _createElementVNode(\"div\", {\n        class: _normalizeClass([\"shell-container\", { open: _unref(isOpen), closed: !_unref(isOpen) }])\n      }, [\n        _createElementVNode(\"div\", {\n          ref_key: \"xterm\",\n          ref: xterm,\n          class: \"shell-body\"\n        }, null, 512),\n        _createVNode(_component_resize_observer, { onNotify: fit })\n      ], 2)\n    ]),\n    _: 1\n  }, 8, [\"active\"]))\n}\n}\n\n})","<script setup lang=\"ts\">\nimport { useStore } from 'vuex';\nimport { \n  ref, \n  onMounted, \n  onBeforeUnmount, \n  watch,\n  PropType,\n} from 'vue';\n\nimport Socket, {\n  EVENT_CONNECTED,\n  EVENT_CONNECTING,\n  EVENT_DISCONNECTED,\n  EVENT_MESSAGE,\n  EVENT_CONNECT_ERROR,\n} from '@shell/utils/socket';\nimport { allHash } from '@shell/utils/promise';\nimport { addParams } from '@shell/utils/url';\nimport { base64Decode, base64Encode } from '@shell/utils/crypto';\nimport { useApplicationSocketMixin } from './ApplicationSocketMixin';\n\nimport Select from '@shell/components/form/Select';\nimport Window from '@shell/components/nav/WindowManager/Window';\n\nconst store = useStore();\nconst t = store.getters['i18n/t'];\n\nconst props = defineProps({\n  application: {\n    type: Object as PropType<object>,\n    default: null,\n  },\n  endpoint: {\n    type: String as PropType<string>,\n    default: '',\n  },\n  initialInstance: {\n    type: String,\n    default: null,\n  },\n});\n\nconst {\n  socket,\n  isOpen,\n  backlog,\n  instanceChoices,\n  getRootSocketUrl,\n} = useApplicationSocketMixin(props);\n\nconst active = ref<boolean>(true);\nconst xterm = ref<HTMLElement | null>(null);\nconst instance = ref<string>(props.initialInstance || instanceChoices.value[0]);\nconst terminal = ref<object | null>(null);\nconst fitAddon = ref<object | null>(null);\nconst searchAddon = ref<object | null>(null);\nconst webglAddon = ref<object | null>(null);\nconst isOpening = ref<boolean>(false);\nconst keepAliveTimer = ref<object | null>(null);\nconst xtermConfig = {\n  allowProposedApi: true,\n  cursorBlink:      true,\n  useStyle:         true,\n  fontSize:         12,\n};\n\nwatch(\n  () => instance.value,\n  () => {\n    connect();\n  }\n);\n\nonBeforeUnmount(() => {\n  clearInterval(keepAliveTimer.value);\n  cleanup();\n});\n\nonMounted(async () => {\n  await setupTerminal();\n  await connect();\n\n  isOpen.value = true;\n\n  clearInterval(keepAliveTimer.value);\n  keepAliveTimer.value = setInterval(() => {\n    fit();\n  }, 60 * 1000);\n}); \n\nconst setupTerminal = async () => {\n  const docStyle = getComputedStyle(document.querySelector('body'));\n  const xtermLib = await import('xterm');\n\n  const addons = await allHash({\n    fit:      import('xterm-addon-fit'),\n    webgl:    import('xterm-addon-webgl'),\n    weblinks: import('xterm-addon-web-links'),\n    search:   import('xterm-addon-search'),\n  });\n\n  const terminalTemp = new xtermLib.Terminal({\n    theme: {\n      background: docStyle.getPropertyValue('--terminal-bg').trim(),\n      foreground: docStyle.getPropertyValue('--terminal-text').trim(),\n      cursor: docStyle.getPropertyValue('--terminal-cursor').trim(),\n      selectionBackground: docStyle.getPropertyValue('--terminal-selection').trim(),\n    },\n    ...xtermConfig,\n  });\n\n  fitAddon.value = new addons.fit.FitAddon();\n  searchAddon.value = new addons.search.SearchAddon();\n\n  try {\n    webglAddon.value = new addons.webgl.WebGlAddon();\n  } catch (e: any) { // eslint-disable-line @typescript-eslint/no-unused-vars\n    // Some browsers (Safari) don't support the webgl renderer, so don't use it.\n    webglAddon.value = null;\n  }\n\n  terminalTemp.loadAddon(fitAddon.value);\n  terminalTemp.loadAddon(searchAddon.value);\n  terminalTemp.loadAddon(new addons.weblinks.WebLinksAddon());\n  if (webglAddon.value) {\n    terminalTemp.loadAddon(webglAddon.value);\n  }\n  \n  terminalTemp.open(xterm.value);\n\n  fit();\n  flush();\n\n  terminalTemp.onData((input) => {\n    const msg = `0${ base64Encode(input) }`;\n\n    write(msg);\n  });\n\n  terminal.value = terminalTemp;\n};\n\nconst write = (msg) => {\n  if (isOpen.value) {\n    socket.value.send(msg);\n  } else {\n    backlog.value.push(msg);\n  }\n};\n\nconst clear = () => {\n  terminal.value.clear();\n};\n\nconst getSocketUrl = async () => {\n  const { url, token } = await getRootSocketUrl();\n\n  return addParams(url, {\n    authtoken: token,\n    instance: instance.value,\n  });\n};\n\nconst connect = async () => {\n  if (socket.value) {\n    await socket.value.disconnect();\n    socket.value = null;\n    terminal.value.reset();\n  }\n\n  const url = await getSocketUrl();\n\n  if (!url) {\n    return;\n  }\n\n  socket.value = new Socket(url, false, 0, 'base64.channel.k8s.io');\n\n  socket.value.addEventListener(EVENT_CONNECTING, () => {\n    isOpen.value = false;\n    isOpening.value = true;\n  });\n\n  socket.value.addEventListener(EVENT_CONNECT_ERROR, (e) => {\n    isOpen.value = false;\n    isOpening.value = false;\n    console.error('Connect Error', e);\n  });\n\n  socket.value.addEventListener(EVENT_CONNECTED, () => {\n    isOpen.value = true;\n    isOpening.value = false;\n    fit();\n    flush();\n  });\n\n  socket.value.addEventListener(EVENT_DISCONNECTED, () => {\n    isOpen.value = false;\n    isOpening.value = false;\n  });\n\n  socket.value.addEventListener(EVENT_MESSAGE, (e) => {\n    const type = e.detail.data.substr(0, 1);\n    const msg = base64Decode(e.detail.data.substr(1));\n\n    if (`${ type }` === '1') {\n      terminal.value.write(msg);\n    } else {\n      console.error(msg);\n    }\n  });\n\n  socket.value.connect();\n  terminal.value.focus();\n};\n\nconst flush = () => {\n  const backlogTemp = backlog.value.slice();\n\n  backlog.value = [];\n\n  for (const data of backlogTemp) {\n    socket.value.send(data);\n  }\n};\n\nconst fit = () => {\n  if (!fitAddon.value) {\n    return;\n  }\n  \n  fitAddon.value.fit();\n  const { rows, cols } = fitAddon.value.proposeDimensions();\n\n  if (!isOpen.value) {\n    return;\n  }\n\n  const message = `4${ base64Encode(\n    JSON.stringify({\n      Width:  Math.floor(cols),\n      Height: Math.floor(rows),\n    })\n  ) }`;\n\n  socket.value.send(message);\n};\n\nconst cleanup = () => {\n  if (socket.value) {\n    socket.value.disconnect();\n    socket.value = null;\n  }\n\n  if (terminal.value) {\n    terminal.value.dispose();\n    terminal.value = null;\n  }\n};\n</script>\n\n<template>\n  <Window\n    :active=\"active\"\n    :before-close=\"cleanup\"\n    class=\"epinio-app-shell\"\n  >\n    <template #title>\n      <Select\n        v-if=\"instanceChoices.length > 1\"\n        v-model:value=\"instance\"\n        :disabled=\"instanceChoices.length === 1\"\n        class=\"containerPicker auto-width pull-left\"\n        :options=\"instanceChoices\"\n        :clearable=\"false\"\n        placement=\"top\"\n      />\n      <div class=\"pull-left ml-5\">\n        <button\n          class=\"btn btn-sm bg-primary\"\n          @click=\"clear\"\n        >\n          {{t('wm.containerShell.clear')}}\n        </button>\n      </div>\n      <div class=\"status pull-left\">\n        <span v-if=\"isOpen\" class=\"text-success\">\n          {{t('wm.connection.connected')}}\n        </span>\n        <span \n          v-else-if=\"isOpening\"\n          v-clean-html=\"t('wm.connection.connecting')\"\n          class=\"text-warning\"\n        />\n        <span \n          v-else\n          class=\"text-error\"\n        >\n          {{t('wm.connection.disconnected')}}\n        </span>\n      </div>\n    </template>\n    <template #body>\n      <div\n        class=\"shell-container\"\n        :class=\"{ open: isOpen, closed: !isOpen }\"\n      >\n        <div\n          ref=\"xterm\"\n          class=\"shell-body\"\n        />\n        <resize-observer @notify=\"fit\" />\n      </div>\n    </template>\n  </Window>\n</template>\n\n<style lang=\"scss\">\n.epinio-app-shell {\n  .v-select.inline.vs--single.vs--open .vs__selected {\n    position: inherit;\n  }\n}\n</style>\n\n<style lang=\"scss\" scoped>\n.text-warning {\n  animation: flasher 2.5s linear infinite;\n}\n\n@keyframes flasher {\n  50% {\n    opacity: 0;\n  }\n}\n\n.shell-container {\n  height: 100%;\n  overflow: hidden;\n}\n\n.shell-body {\n  padding: calc(2 * var(--outline-width));\n  height: 100%;\n\n  & > .terminal.focus {\n    outline: var(--outline-width) solid var(--outline);\n  }\n}\n\n.containerPicker {\n  ::v-deep &.unlabeled-select {\n    display: inline-block;\n    min-width: 200px;\n    height: 30px;\n    min-height: 30px;\n    width: initial;\n  }\n}\n\n.status {\n  align-items: center;\n  display: flex;\n  min-width: 80px;\n  height: 30px;\n  margin-left: 10px;\n}\n</style>\n","import script from \"./ApplicationShell.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ApplicationShell.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ApplicationShell.vue?vue&type=style&index=0&id=7bc331ac&lang=scss\"\nimport \"./ApplicationShell.vue?vue&type=style&index=1&id=7bc331ac&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7bc331ac\"]])\n\nexport default __exports__","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".epinio-app-shell .v-select.inline.vs--single.vs--open .vs__selected{position:inherit}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createVNode as _createVNode, normalizeClass as _normalizeClass, vModelText as _vModelText, withDirectives as _withDirectives, resolveComponent as _resolveComponent, withCtx as _withCtx, renderList as _renderList, Fragment as _Fragment, createElementBlock as _createElementBlock, resolveDirective as _resolveDirective } from \"vue\"\n\nconst _hoisted_1 = { class: \"title-inner log-action\" }\nconst _hoisted_2 = { class: \"title-inner-left\" }\nconst _hoisted_3 = [\"disabled\"]\nconst _hoisted_4 = { class: \"title-inner-right\" }\nconst _hoisted_5 = {\n  class: \"status log-action text-center p-10\",\n  style: {\"min-width\":\"80px\"}\n}\nconst _hoisted_6 = { class: \"log-action ml-5\" }\nconst _hoisted_7 = [\"placeholder\"]\nconst _hoisted_8 = { class: \"log-action ml-5\" }\nconst _hoisted_9 = {\n  class: \"fixed\",\n  cellpadding: \"0\",\n  cellspacing: \"0\"\n}\nconst _hoisted_10 = { class: \"logs-body\" }\nconst _hoisted_11 = { class: \"time\" }\nconst _hoisted_12 = { class: \"msg\" }\nconst _hoisted_13 = { key: 1 }\nconst _hoisted_14 = {\n  colspan: \"2\",\n  class: \"msg text-muted\"\n}\nconst _hoisted_15 = { key: 2 }\nconst _hoisted_16 = {\n  colspan: \"2\",\n  class: \"msg text-muted\"\n}\n\nimport { useStore } from 'vuex';\nimport { \n  ref, \n  onMounted, \n  onBeforeUnmount, \n  computed, \n  nextTick, \n  PropType,\n} from 'vue';\n\nimport Socket, {\n  EVENT_CONNECTED,\n  EVENT_DISCONNECTED,\n  EVENT_MESSAGE,\n  EVENT_CONNECT_ERROR\n} from '@shell/utils/socket';\nimport day from 'dayjs';\nimport AnsiUp from 'ansi_up';\nimport { addParams } from '@shell/utils/url';\nimport { downloadFile } from '@shell/utils/download';\nimport { escapeHtml, escapeRegex } from '@shell/utils/string';\nimport { LOGS_TIME, LOGS_WRAP, DATE_FORMAT, TIME_FORMAT } from '@shell/store/prefs';\n\nimport Select from '@shell/components/form/Select';\nimport { Checkbox } from '@components/Form/Checkbox';\nimport AsyncButton from '@shell/components/AsyncButton';\nimport Window from '@shell/components/nav/WindowManager/Window';\n\nimport { useApplicationSocketMixin } from './ApplicationSocketMixin';\n\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'ApplicationLogs',\n  props: {\n  application: {\n    type: Object as PropType<object>,\n    default: null,\n  },\n  endpoint: {\n    type: String as PropType<string>,\n    default: '',\n  },\n  ansiToHtml: {\n    type: Boolean as PropType<boolean>,\n    default: false,\n  },\n  initialInstance: {\n    type:    String,\n    default: null,\n  },\n},\n  setup(__props) {\n\nconst store = useStore();\nconst t = store.getters['i18n/t'];\n\nconst props = __props;\n\nconst {\n  socket,\n  isOpen,\n  backlog,\n  instanceChoices,\n  getRootSocketUrl,\n} = useApplicationSocketMixin(props);\n\nconst lastId = ref<number>(1);\nconst search = ref<string>('');\nconst instance = ref<string>(props.initialInstance || instanceChoices[0]);\nconst lines = ref<Array<any>>([]);\nconst timerFlush = ref<object>(null);\nconst isFollowing = ref<boolean>(false);\nconst active = ref<boolean>(true);\nconst body = ref<HTMLElement>(null);\n\nconst ansiup = new AnsiUp();\nconst timestamps = store.getters['prefs/get'](LOGS_TIME);\nconst wrap = ref<boolean>(store.getters['prefs/get'](LOGS_WRAP));\n\nonMounted(async () => {\n  await connect();\n  let boundUpdateFollowing = updateFollowing.bind(body);\n  body.value.addEventListener('scroll', boundUpdateFollowing);\n  timerFlush.value = setInterval(flush, 100);\n});\n\nonBeforeUnmount(() => {\n  const el = document.querySelector('.logs-container') as HTMLElement;\n  if (el) {\n    el.removeEventListener('scroll', updateFollowing);\n  }\n  cleanup();\n  isOpen.value = false;\n});\n\nconst instanceChoicesWithNone = computed(() => {\n  return [\n    ...instanceChoices.value,\n    {\n      label: 'No Instance Filter',\n      value: null\n    }\n  ];\n});\n\nconst filtered = computed(() => {\n  if (!search.value && !instance.value) {\n    return lines.value;\n  }\n\n  const re = new RegExp(escapeRegex(search.value), 'img');\n  const out = [];\n\n  for (const line of lines.value) {\n    let msg = line.rawMsg;\n\n    if (instance.value) {\n      const pod = msg.substring(1, msg.length);\n\n      if (!pod.startsWith(instance.value)) {\n        continue;\n      }\n    }\n\n    const matches = msg.match(re);\n\n    if (!matches) {\n      continue;\n    }\n\n    const parts = msg.split(re);\n\n    msg = '';\n    while (parts.length || matches.length) {\n      if (parts.length) {\n        msg += ansiup.ansi_to_html(parts.shift()); // This also escapes\n      }\n\n      if (matches.length) {\n        msg += `<span class=\"highlight\">${ ansiup.ansi_to_html(matches.shift()) }</span>`;\n      }\n    }\n\n    out.push({\n      id:   line.id,\n      time: line.time,\n      msg,\n    });\n  }\n\n  return out;\n});\n\nconst timeFormatStr = computed(() => {\n  const dateFormat = escapeHtml(store.getters['prefs/get'](DATE_FORMAT));\n  const timeFormat = escapeHtml(store.getters['prefs/get'](TIME_FORMAT));\n\n  return `${ dateFormat } ${ timeFormat }`;\n});\n\nconst getSocketUrl = async () => {\n  const { url, token } = await getRootSocketUrl();\n  return addParams(url, { follow: true, authtoken: token });\n};\n\nconst connect = async () => {\n  if (socket.value) {\n    await socket.value.disconnect();\n    socket.value = null;\n    lines.value = [];\n  }\n\n  lines.value = [];\n\n  const url = await getSocketUrl();\n  socket.value = new Socket(url, true, 0);\n  socket.value.setAutoReconnectUrl(async() => {\n    return await getSocketUrl();\n  });\n\n  socket.value.addEventListener(EVENT_CONNECTED, () => {\n    isOpen.value = true;\n  });\n\n  socket.value.addEventListener(EVENT_DISCONNECTED, () => {\n    isOpen.value = false;\n  });\n\n  socket.value.addEventListener(EVENT_CONNECT_ERROR, (e: any) => {\n    isOpen.value = false;\n    console.error('Connect Error', e);\n  });\n\n  socket.value.addEventListener(EVENT_MESSAGE, async (e: any) => {\n    let parsedData;\n    \n    try {\n      parsedData = JSON.parse(e.detail.data);\n    } catch (e) {\n      console.warn('Unable to parse websocket data: ', e);\n      return;\n    }\n\n    const { PodName, Message } = parsedData;\n\n    const line = `[${ PodName }] ${ Message }`;\n    backlog.value.push({\n      id:     lastId.value++,\n      msg:    props.ansiToHtml ? ansiup.ansi_to_html(line) : line,\n      rawMsg: line,\n    });\n  });\n  \n  socket.value.connect();\n};\n\nconst flush = () => {\n  if (backlog.value.length) {\n    lines.value.push(...backlog.value);\n    backlog.value = [];\n  }\n\n  if (isFollowing.value) {\n    nextTick(() => {\n      follow();\n    });\n  }\n};\n\nconst updateFollowing = () => {\n  const el = body.value;\n\n  isFollowing.value = el.scrollTop + el.clientHeight + 2 >= el.scrollHeight;\n};\n\nconst clear = () => {\n  lines.value = [];\n};\n\nconst download = (btnCb) => {\n  const date = new Date().toISOString().split('.')[0];\n  const fileName = `${ props.application.nameDisplay }-${ date }`;\n\n  downloadFile(fileName, lines.value.map((l) => `${ l.rawMsg }`).join('\\n'))\n    .then(() => btnCb(true))\n    .catch(() => btnCb(false));\n};\n\nconst follow = () => {\n  body.value.scrollTop = body.value.scrollHeight;\n};\n\nconst toggleWrap = () => {\n  store.dispatch('prefs/set', { key: LOGS_WRAP, value: wrap.value });\n};\n\nconst format = (time) => {\n  if (!time) {\n    return '';\n  }\n\n  return day(time).format(timeFormatStr.value);\n};\n\nconst cleanup = () => {\n  if (socket.value) {\n    socket.value.disconnect();\n    socket.value = null;\n  }\n\n  clearInterval(timerFlush.value);\n};\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_VDropdown = _resolveComponent(\"VDropdown\")!\n  const _directive_clean_html = _resolveDirective(\"clean-html\")!\n\n  return (_openBlock(), _createBlock(_unref(Window), {\n    active: active.value,\n    \"before-close\": cleanup,\n    class: \"epinio-app-log\"\n  }, {\n    title: _withCtx(() => [\n      _createElementVNode(\"div\", _hoisted_1, [\n        _createElementVNode(\"div\", _hoisted_2, [\n          (_unref(instanceChoices).length > 1)\n            ? (_openBlock(), _createBlock(_unref(Select), {\n                key: 0,\n                value: instance.value,\n                \"onUpdate:value\": _cache[0] || (_cache[0] = ($event: any) => ((instance).value = $event)),\n                disabled: _unref(instanceChoices).length === 1,\n                class: \"containerPicker auto-width\",\n                options: instanceChoicesWithNone.value,\n                clearable: true,\n                placement: \"top\",\n                placeholder: \"Filter by Instance\"\n              }, null, 8, [\"value\", \"disabled\", \"options\"]))\n            : _createCommentVNode(\"\", true),\n          _createElementVNode(\"button\", {\n            class: \"btn bg-primary ml-5\",\n            disabled: isFollowing.value,\n            onClick: follow\n          }, _toDisplayString(_unref(t)('wm.containerLogs.follow')), 9, _hoisted_3),\n          _createElementVNode(\"button\", {\n            class: \"btn bg-primary ml-5\",\n            onClick: clear\n          }, _toDisplayString(_unref(t)('wm.containerLogs.clear')), 1),\n          _createVNode(_unref(AsyncButton), {\n            class: \"ml-5\",\n            mode: \"download\",\n            onClick: download\n          })\n        ]),\n        _cache[4] || (_cache[4] = _createElementVNode(\"div\", { style: {\"flex\":\"1\"} }, null, -1)),\n        _createElementVNode(\"div\", _hoisted_4, [\n          _createElementVNode(\"div\", _hoisted_5, [\n            _createElementVNode(\"span\", {\n              class: _normalizeClass({'text-success': _unref(isOpen), 'text-error': !_unref(isOpen)})\n            }, _toDisplayString(_unref(t)(_unref(isOpen) ? 'wm.connection.connected' : 'wm.connection.disconnected')), 3)\n          ]),\n          _createElementVNode(\"div\", _hoisted_6, [\n            _withDirectives(_createElementVNode(\"input\", {\n              \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((search).value = $event)),\n              class: \"input-sm\",\n              type: \"search\",\n              placeholder: _unref(t)('wm.containerLogs.search')\n            }, null, 8, _hoisted_7), [\n              [_vModelText, search.value]\n            ])\n          ]),\n          _createElementVNode(\"div\", _hoisted_8, [\n            _createVNode(_component_VDropdown, { placement: \"top\" }, {\n              popper: _withCtx(() => [\n                _createVNode(_unref(Checkbox), {\n                  value: wrap.value,\n                  \"onUpdate:value\": [\n                    _cache[2] || (_cache[2] = ($event: any) => ((wrap).value = $event)),\n                    toggleWrap\n                  ],\n                  label: _unref(t)('wm.containerLogs.wrap')\n                }, null, 8, [\"value\", \"label\"])\n              ]),\n              default: _withCtx(() => [\n                _cache[3] || (_cache[3] = _createElementVNode(\"button\", { class: \"btn bg-primary\" }, [\n                  _createElementVNode(\"i\", { class: \"icon icon-gear\" })\n                ], -1))\n              ]),\n              _: 1,\n              __: [3]\n            })\n          ])\n        ])\n      ])\n    ]),\n    body: _withCtx(() => [\n      _createElementVNode(\"div\", {\n        ref_key: \"body\",\n        ref: body,\n        class: _normalizeClass({'logs-container': true, 'open': _unref(isOpen), 'closed': !_unref(isOpen), 'show-times': _unref(timestamps) && filtered.value.length, 'wrap-lines': wrap.value})\n      }, [\n        _createElementVNode(\"table\", _hoisted_9, [\n          _createElementVNode(\"tbody\", _hoisted_10, [\n            (filtered.value.length)\n              ? (_openBlock(true), _createElementBlock(_Fragment, { key: 0 }, _renderList(filtered.value, (line) => {\n                  return (_openBlock(), _createElementBlock(\"tr\", {\n                    key: line.id\n                  }, [\n                    _withDirectives(_createElementVNode(\"td\", _hoisted_11, null, 512), [\n                      [_directive_clean_html, format(line.time)]\n                    ]),\n                    _withDirectives(_createElementVNode(\"td\", _hoisted_12, null, 512), [\n                      [_directive_clean_html, line.msg]\n                    ])\n                  ]))\n                }), 128))\n              : (search.value)\n                ? (_openBlock(), _createElementBlock(\"tr\", _hoisted_13, [\n                    _createElementVNode(\"td\", _hoisted_14, _toDisplayString(_unref(t)('wm.containerLogs.noMatch')), 1)\n                  ]))\n                : (_openBlock(), _createElementBlock(\"tr\", _hoisted_15, [\n                    _createElementVNode(\"td\", _hoisted_16, _toDisplayString(_unref(t)('epinio.applications.wm.noData')), 1)\n                  ]))\n          ])\n        ])\n      ], 2)\n    ]),\n    _: 1\n  }, 8, [\"active\"]))\n}\n}\n\n})","<script setup lang=\"ts\">\nimport { useStore } from 'vuex';\nimport { \n  ref, \n  onMounted, \n  onBeforeUnmount, \n  computed, \n  nextTick, \n  PropType,\n} from 'vue';\n\nimport Socket, {\n  EVENT_CONNECTED,\n  EVENT_DISCONNECTED,\n  EVENT_MESSAGE,\n  EVENT_CONNECT_ERROR\n} from '@shell/utils/socket';\nimport day from 'dayjs';\nimport AnsiUp from 'ansi_up';\nimport { addParams } from '@shell/utils/url';\nimport { downloadFile } from '@shell/utils/download';\nimport { escapeHtml, escapeRegex } from '@shell/utils/string';\nimport { LOGS_TIME, LOGS_WRAP, DATE_FORMAT, TIME_FORMAT } from '@shell/store/prefs';\n\nimport Select from '@shell/components/form/Select';\nimport { Checkbox } from '@components/Form/Checkbox';\nimport AsyncButton from '@shell/components/AsyncButton';\nimport Window from '@shell/components/nav/WindowManager/Window';\n\nimport { useApplicationSocketMixin } from './ApplicationSocketMixin';\n\nconst store = useStore();\nconst t = store.getters['i18n/t'];\n\nconst props = defineProps({\n  application: {\n    type: Object as PropType<object>,\n    default: null,\n  },\n  endpoint: {\n    type: String as PropType<string>,\n    default: '',\n  },\n  ansiToHtml: {\n    type: Boolean as PropType<boolean>,\n    default: false,\n  },\n  initialInstance: {\n    type:    String,\n    default: null,\n  },\n});\n\nconst {\n  socket,\n  isOpen,\n  backlog,\n  instanceChoices,\n  getRootSocketUrl,\n} = useApplicationSocketMixin(props);\n\nconst lastId = ref<number>(1);\nconst search = ref<string>('');\nconst instance = ref<string>(props.initialInstance || instanceChoices[0]);\nconst lines = ref<Array<any>>([]);\nconst timerFlush = ref<object>(null);\nconst isFollowing = ref<boolean>(false);\nconst active = ref<boolean>(true);\nconst body = ref<HTMLElement>(null);\n\nconst ansiup = new AnsiUp();\nconst timestamps = store.getters['prefs/get'](LOGS_TIME);\nconst wrap = ref<boolean>(store.getters['prefs/get'](LOGS_WRAP));\n\nonMounted(async () => {\n  await connect();\n  let boundUpdateFollowing = updateFollowing.bind(body);\n  body.value.addEventListener('scroll', boundUpdateFollowing);\n  timerFlush.value = setInterval(flush, 100);\n});\n\nonBeforeUnmount(() => {\n  const el = document.querySelector('.logs-container') as HTMLElement;\n  if (el) {\n    el.removeEventListener('scroll', updateFollowing);\n  }\n  cleanup();\n  isOpen.value = false;\n});\n\nconst instanceChoicesWithNone = computed(() => {\n  return [\n    ...instanceChoices.value,\n    {\n      label: 'No Instance Filter',\n      value: null\n    }\n  ];\n});\n\nconst filtered = computed(() => {\n  if (!search.value && !instance.value) {\n    return lines.value;\n  }\n\n  const re = new RegExp(escapeRegex(search.value), 'img');\n  const out = [];\n\n  for (const line of lines.value) {\n    let msg = line.rawMsg;\n\n    if (instance.value) {\n      const pod = msg.substring(1, msg.length);\n\n      if (!pod.startsWith(instance.value)) {\n        continue;\n      }\n    }\n\n    const matches = msg.match(re);\n\n    if (!matches) {\n      continue;\n    }\n\n    const parts = msg.split(re);\n\n    msg = '';\n    while (parts.length || matches.length) {\n      if (parts.length) {\n        msg += ansiup.ansi_to_html(parts.shift()); // This also escapes\n      }\n\n      if (matches.length) {\n        msg += `<span class=\"highlight\">${ ansiup.ansi_to_html(matches.shift()) }</span>`;\n      }\n    }\n\n    out.push({\n      id:   line.id,\n      time: line.time,\n      msg,\n    });\n  }\n\n  return out;\n});\n\nconst timeFormatStr = computed(() => {\n  const dateFormat = escapeHtml(store.getters['prefs/get'](DATE_FORMAT));\n  const timeFormat = escapeHtml(store.getters['prefs/get'](TIME_FORMAT));\n\n  return `${ dateFormat } ${ timeFormat }`;\n});\n\nconst getSocketUrl = async () => {\n  const { url, token } = await getRootSocketUrl();\n  return addParams(url, { follow: true, authtoken: token });\n};\n\nconst connect = async () => {\n  if (socket.value) {\n    await socket.value.disconnect();\n    socket.value = null;\n    lines.value = [];\n  }\n\n  lines.value = [];\n\n  const url = await getSocketUrl();\n  socket.value = new Socket(url, true, 0);\n  socket.value.setAutoReconnectUrl(async() => {\n    return await getSocketUrl();\n  });\n\n  socket.value.addEventListener(EVENT_CONNECTED, () => {\n    isOpen.value = true;\n  });\n\n  socket.value.addEventListener(EVENT_DISCONNECTED, () => {\n    isOpen.value = false;\n  });\n\n  socket.value.addEventListener(EVENT_CONNECT_ERROR, (e: any) => {\n    isOpen.value = false;\n    console.error('Connect Error', e);\n  });\n\n  socket.value.addEventListener(EVENT_MESSAGE, async (e: any) => {\n    let parsedData;\n    \n    try {\n      parsedData = JSON.parse(e.detail.data);\n    } catch (e) {\n      console.warn('Unable to parse websocket data: ', e);\n      return;\n    }\n\n    const { PodName, Message } = parsedData;\n\n    const line = `[${ PodName }] ${ Message }`;\n    backlog.value.push({\n      id:     lastId.value++,\n      msg:    props.ansiToHtml ? ansiup.ansi_to_html(line) : line,\n      rawMsg: line,\n    });\n  });\n  \n  socket.value.connect();\n};\n\nconst flush = () => {\n  if (backlog.value.length) {\n    lines.value.push(...backlog.value);\n    backlog.value = [];\n  }\n\n  if (isFollowing.value) {\n    nextTick(() => {\n      follow();\n    });\n  }\n};\n\nconst updateFollowing = () => {\n  const el = body.value;\n\n  isFollowing.value = el.scrollTop + el.clientHeight + 2 >= el.scrollHeight;\n};\n\nconst clear = () => {\n  lines.value = [];\n};\n\nconst download = (btnCb) => {\n  const date = new Date().toISOString().split('.')[0];\n  const fileName = `${ props.application.nameDisplay }-${ date }`;\n\n  downloadFile(fileName, lines.value.map((l) => `${ l.rawMsg }`).join('\\n'))\n    .then(() => btnCb(true))\n    .catch(() => btnCb(false));\n};\n\nconst follow = () => {\n  body.value.scrollTop = body.value.scrollHeight;\n};\n\nconst toggleWrap = () => {\n  store.dispatch('prefs/set', { key: LOGS_WRAP, value: wrap.value });\n};\n\nconst format = (time) => {\n  if (!time) {\n    return '';\n  }\n\n  return day(time).format(timeFormatStr.value);\n};\n\nconst cleanup = () => {\n  if (socket.value) {\n    socket.value.disconnect();\n    socket.value = null;\n  }\n\n  clearInterval(timerFlush.value);\n};\n</script>\n\n<template>\n  <Window\n    :active=\"active\"\n    :before-close=\"cleanup\"\n    class=\"epinio-app-log\"\n  >\n    <template #title>\n      <div class=\"title-inner log-action \">\n        <div class=\"title-inner-left\">\n          <Select\n            v-if=\"instanceChoices.length > 1\"\n            v-model:value=\"instance\"\n            :disabled=\"instanceChoices.length === 1\"\n            class=\"containerPicker auto-width\"\n            :options=\"instanceChoicesWithNone\"\n            :clearable=\"true\"\n            placement=\"top\"\n            placeholder=\"Filter by Instance\"\n          />\n\n          <button\n            class=\"btn bg-primary ml-5\"\n            :disabled=\"isFollowing\"\n            @click=\"follow\"\n          >\n            {{t('wm.containerLogs.follow')}}\n          </button>\n           <button\n            class=\" btn bg-primary ml-5\"\n            @click=\"clear\"\n          >\n            {{t('wm.containerLogs.clear')}}\n          </button>\n          <AsyncButton\n            class=\"ml-5\"\n            mode=\"download\"\n            @click=\"download\"\n          />\n        </div>\n        <div style=\"flex: 1;\" />\n        <div class=\"title-inner-right\">\n          <div\n            class=\"status log-action text-center p-10\"\n            style=\"min-width: 80px;\"\n          >\n            <span :class=\"{'text-success': isOpen, 'text-error': !isOpen}\">\n              {{t(isOpen ? 'wm.connection.connected' : 'wm.connection.disconnected')}}\n            </span>\n          </div>\n          <div class=\"log-action  ml-5\">\n            <input\n              v-model=\"search\"\n              class=\"input-sm\"\n              type=\"search\"\n              :placeholder=\"t('wm.containerLogs.search')\"\n            >\n          </div>\n          <div class=\"log-action ml-5\">\n            <VDropdown placement=\"top\">\n              <button class=\"btn bg-primary\">\n                <i class=\"icon icon-gear\" />\n              </button>\n              <template #popper>\n                <Checkbox\n                  v-model:value=\"wrap\"\n                  :label=\"t('wm.containerLogs.wrap')\"\n                  @update:value=\"toggleWrap\"\n                />\n              </template>\n            </VDropdown>\n          </div>\n        </div>\n      </div>\n    </template>\n    <template #body>\n      <div\n        ref=\"body\"\n        :class=\"{'logs-container': true, 'open': isOpen, 'closed': !isOpen, 'show-times': timestamps && filtered.length, 'wrap-lines': wrap}\"\n      >\n        <table\n          class=\"fixed\"\n          cellpadding=\"0\"\n          cellspacing=\"0\"\n        >\n          <tbody class=\"logs-body\">\n            <template v-if=\"filtered.length\">\n              <tr\n                v-for=\"line in filtered\"\n                :key=\"line.id\"\n              >\n                <td\n                  v-clean-html=\"format(line.time)\"\n                  class=\"time\"\n                />\n                <td\n                  v-clean-html=\"line.msg\"\n                  class=\"msg\"\n                />\n              </tr>\n            </template>\n            <tr v-else-if=\"search\">\n              <td colspan=\"2\" class=\"msg text-muted\">\n                {{t('wm.containerLogs.noMatch')}}\n              </td>\n            </tr>\n            <tr v-else>\n              <td colspan=\"2\" class=\"msg text-muted\">\n                {{t('epinio.applications.wm.noData')}}\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </template>\n  </Window>\n</template>\n\n<style lang=\"scss\">\n.epinio-app-log {\n  .v-select.inline.vs--single.vs--open .vs__selected {\n    position: inherit;\n  }\n}\n</style>\n\n<style lang=\"scss\" scoped>\n  .title-inner {\n    display: flex;\n    flex-direction: row;\n  }\n  .title-inner {\n    display: flex;\n    flex-direction: row;\n    &-left, &-right {\n      display: flex;\n      flex-direction: row;\n    }\n  }\n  // .title-left {\n\n  // }\n\n  .logs-container {\n    height: 100%;\n    overflow: auto;\n    padding: 5px;\n    background-color: var(--logs-bg);\n    font-family: Menlo,Consolas,monospace;\n    color: var(--logs-text);\n\n    .closed {\n      opacity: 0.25;\n    }\n\n    .time {\n      white-space: nowrap;\n      display: none;\n      width: 0;\n      padding-right: 15px;\n      user-select: none;\n    }\n\n    &.show-times .time {\n      display: initial;\n      width: auto;\n    }\n\n    .msg {\n      white-space: nowrap;\n\n      .highlight {\n        color: var(--logs-highlight);\n        background-color: var(--logs-highlight-bg);\n      }\n    }\n\n    &.wrap-lines .msg {\n      white-space: normal;\n    }\n  }\n\n  .containerPicker {\n    ::v-deep &.unlabeled-select {\n      display: inline-block;\n      min-width: 200px;\n      height: 30px;\n      min-height: 30px;\n      width: initial;\n    }\n  }\n\n  .log-action {\n    button {\n      border: 0 !important;\n      min-height: 30px;\n      line-height: 30px;\n    }\n\n    > input {\n      height: 30px;\n    }\n  }\n\n  .status {\n    align-items: center;\n    display: flex;\n    min-width: 80px;\n    height: 30px;\n  }\n\n  .filter-popup {\n    > * {\n      margin-bottom: 10px;\n    }\n  }\n\n  .title-left {\n    display: flex;\n  }\n</style>\n\n","import script from \"./ApplicationLogs.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ApplicationLogs.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ApplicationLogs.vue?vue&type=style&index=0&id=66118bd8&lang=scss\"\nimport \"./ApplicationLogs.vue?vue&type=style&index=1&id=66118bd8&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-66118bd8\"]])\n\nexport default __exports__","import { useStore } from 'vuex';\nimport { ref, computed } from 'vue';\n\nimport { EPINIO_MGMT_STORE, EPINIO_PRODUCT_NAME, EPINIO_TYPES } from '../types';\n\nexport function useApplicationSocketMixin(props: any) {\n  const store = useStore();\n  const socket = ref<any>(null);\n  const isOpen = ref<boolean>(false);\n  const backlog = ref<Array<any>>([]);\n\n  const instanceChoices = computed(() => {\n    return props.application.instances.map((instance: any) => instance.id);\n  });\n\n  const getRootSocketUrl = async () => {\n    const { token } = await store.dispatch(\n      `epinio/request`, \n      { opt: { url: '/api/v1/authtoken' } },\n    );\n\n    const isSingleProduct = !!store.getters['isSingleProduct'];\n    let api = '';\n    let prependPath = '';\n\n    console.log(store);\n    if (isSingleProduct) {\n      const cnsi = store.getters[`${ EPINIO_PRODUCT_NAME }/singleProductCNSI`]();\n\n      prependPath = `/pp/v1/direct/ws/${ cnsi?.guid }`;\n    } else {\n      const currentClusterId = store.getters['clusterId'];\n      const currentCluster = store.getters[`${ EPINIO_MGMT_STORE }/byId`](\n        EPINIO_TYPES.CLUSTER, \n        currentClusterId,\n      );\n\n      api = currentCluster.api;\n    }\n\n    return {\n      url: `${ api }${ prependPath }${ props.endpoint }`.replace(/^http/, 'ws'),\n      token\n    };\n  }\n\n  return {\n    socket,\n    isOpen,\n    backlog,\n    instanceChoices,\n    getRootSocketUrl,\n  };\n};\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".epinio-app-log .v-select.inline.vs--single.vs--open .vs__selected{position:inherit}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-23.use[1]!../../../node_modules/vue-loader/dist/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[3]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-23.use[4]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[1]!./ApplicationLogs.vue?vue&type=style&index=1&id=66118bd8&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"0307dae3\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-23.use[1]!../../../node_modules/vue-loader/dist/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[3]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-23.use[4]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[1]!./ApplicationShell.vue?vue&type=style&index=1&id=7bc331ac&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"5ca08394\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".text-warning[data-v-7bc331ac]{animation:flasher-7bc331ac 2.5s linear infinite}@keyframes flasher-7bc331ac{50%{opacity:0}}.shell-container[data-v-7bc331ac]{height:100%;overflow:hidden}.shell-body[data-v-7bc331ac]{padding:calc(var(--outline-width)*2);height:100%}.shell-body>.terminal.focus[data-v-7bc331ac]{outline:var(--outline-width) solid var(--outline)}[data-v-7bc331ac] .containerPicker.unlabeled-select{display:inline-block;min-width:200px;height:30px;min-height:30px;width:auto}.status[data-v-7bc331ac]{align-items:center;display:flex;min-width:80px;height:30px;margin-left:10px}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n"],"names":["content","__esModule","default","module","id","locals","exports","add","___CSS_LOADER_EXPORT___","push","_hoisted_1","class","_hoisted_2","_hoisted_3","key","_hoisted_4","_hoisted_5","_defineComponent","__name","props","application","type","Object","endpoint","String","initialInstance","setup","__props","store","useStore","t","getters","socket","isOpen","backlog","instanceChoices","getRootSocketUrl","useApplicationSocketMixin","active","ref","xterm","instance","value","terminal","fitAddon","searchAddon","webglAddon","isOpening","keepAliveTimer","xtermConfig","allowProposedApi","cursorBlink","useStyle","fontSize","watch","connect","onBeforeUnmount","clearInterval","cleanup","onMounted","async","setupTerminal","setInterval","fit","docStyle","getComputedStyle","document","querySelector","xtermLib","addons","allHash","webgl","weblinks","search","terminalTemp","Terminal","theme","background","getPropertyValue","trim","foreground","cursor","selectionBackground","FitAddon","SearchAddon","WebGlAddon","e","loadAddon","WebLinksAddon","open","flush","onData","input","msg","base64Encode","write","send","clear","getSocketUrl","url","token","addParams","authtoken","disconnect","reset","Socket","addEventListener","EVENT_CONNECTING","EVENT_CONNECT_ERROR","console","error","EVENT_CONNECTED","EVENT_DISCONNECTED","EVENT_MESSAGE","detail","data","substr","base64Decode","focus","backlogTemp","slice","rows","cols","proposeDimensions","message","JSON","stringify","Width","Math","floor","Height","dispose","_ctx","_cache","_component_resize_observer","_resolveComponent","_directive_clean_html","_resolveDirective","_openBlock","_createBlock","_unref","Window","title","_withCtx","length","Select","$event","disabled","options","clearable","placement","_createCommentVNode","_createElementVNode","onClick","_toDisplayString","_createElementBlock","_withDirectives","body","_normalizeClass","closed","ref_key","_createVNode","onNotify","_","__exports__","style","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","cellpadding","cellspacing","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","colspan","_hoisted_15","_hoisted_16","ansiToHtml","Boolean","lastId","lines","timerFlush","isFollowing","ansiup","AnsiUp","timestamps","LOGS_TIME","wrap","LOGS_WRAP","boundUpdateFollowing","updateFollowing","bind","el","removeEventListener","instanceChoicesWithNone","computed","label","filtered","re","RegExp","escapeRegex","out","line","rawMsg","pod","substring","startsWith","matches","match","parts","split","ansi_to_html","shift","time","timeFormatStr","dateFormat","escapeHtml","DATE_FORMAT","timeFormat","TIME_FORMAT","follow","setAutoReconnectUrl","parsedData","parse","warn","PodName","Message","nextTick","scrollTop","clientHeight","scrollHeight","download","btnCb","date","Date","toISOString","fileName","nameDisplay","downloadFile","map","l","join","then","catch","toggleWrap","dispatch","format","day","_component_VDropdown","placeholder","AsyncButton","mode","_vModelText","popper","Checkbox","__","_Fragment","_renderList","instances","opt","isSingleProduct","api","prependPath","log","cnsi","EPINIO_PRODUCT_NAME","guid","currentClusterId","currentCluster","EPINIO_MGMT_STORE","EPINIO_TYPES","CLUSTER","replace"],"sourceRoot":""}