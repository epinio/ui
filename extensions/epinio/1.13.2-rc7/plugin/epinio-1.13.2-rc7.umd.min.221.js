(("undefined"!==typeof self?self:this)["webpackChunkepinio_1_13_2_rc7"]=("undefined"!==typeof self?self:this)["webpackChunkepinio_1_13_2_rc7"]||[]).push([[221],{22040:function(e,t,a){"use strict";a.r(t);var s=a(36758),r=a.n(s),o=a(40935),n=a.n(o),i=n()(r());i.push([e.id,".resource-tabs.view[data-v-65888363]  .tabs.horizontal{border:none}.resource-tabs.view[data-v-65888363]  .tabs.horizontal+.tab-container{border:none;border-top:1px solid var(--border);padding:0;padding-top:24px}.tab-caption[data-v-65888363]{align-items:center;font-size:16px;margin-bottom:24px}.tab-caption .namespace-name[data-v-65888363]{display:inline;font-weight:700;margin-right:0 4px;white-space:nowrap}",""]),t["default"]=i},25221:function(e,t,a){"use strict";a.d(t,{A:function(){return V}});var s=a(9274);const r={key:0,class:"tab-caption"},o={class:"mt-20"};function n(e,t,a,n,i,l){const d=(0,s.resolveComponent)("Conditions"),c=(0,s.resolveComponent)("Tab"),u=(0,s.resolveComponent)("PaginatedResourceTable"),p=(0,s.resolveComponent)("RelatedResources"),h=(0,s.resolveComponent)("Tabbed"),m=(0,s.resolveDirective)("clean-html"),g=(0,s.resolveDirective)("t");return(0,s.openBlock)(),(0,s.createBlock)(h,(0,s.mergeProps)({class:["resource-tabs",{[a.mode]:!0}]},e.$attrs,{"default-tab":a.defaultTab,resource:a.value,"use-hash":a.useHash,onChanged:e.tabChange}),{default:(0,s.withCtx)(()=>[(0,s.renderSlot)(e.$slots,"default",{},void 0,!0),i.showConditions?((0,s.openBlock)(),(0,s.createBlock)(c,{key:0,"label-key":"resourceTabs.conditions.tab",name:"conditions",weight:-1,"display-alert-icon":l.conditionsHaveIssues},{default:(0,s.withCtx)(()=>[(0,s.createVNode)(d,{value:a.value},null,8,["value"])]),_:1},8,["display-alert-icon"])):(0,s.createCommentVNode)("",!0),l.showEvents?((0,s.openBlock)(),(0,s.createBlock)(c,{key:1,label:l.isNamespace?e.t("resourceTabs.events.namespaceTab"):e.t("resourceTabs.events.tab"),name:"events",weight:-2},{default:(0,s.withCtx)(()=>[l.isNamespace?(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",r,null,512)),[[m,e.t("resourceTabs.events.namespaceCaption",{namespace:a.value.metadata.name},!0)]]):(0,s.createCommentVNode)("",!0),(0,s.createVNode)(u,{schema:i.eventSchema,"local-filter":l.filterEventsLocal,"api-filter":l.filterEventsApi,"use-query-params-for-simple-filtering":!1,headers:l.eventHeaders,paginationHeaders:i.paginationHeaders,namespaced:!1},null,8,["schema","local-filter","api-filter","headers","paginationHeaders"])]),_:1},8,["label"])):(0,s.createCommentVNode)("",!0),l.showRelated?((0,s.openBlock)(),(0,s.createBlock)(c,{key:2,name:"related","label-key":"resourceTabs.related.tab",weight:-3},{default:(0,s.withCtx)(()=>[(0,s.withDirectives)((0,s.createElementVNode)("h3",null,null,512),[[g,"resourceTabs.related.from"]]),(0,s.createVNode)(p,{"ignore-types":[a.value.type],value:a.value,direction:"from"},null,8,["ignore-types","value"]),(0,s.withDirectives)((0,s.createElementVNode)("h3",o,null,512),[[g,"resourceTabs.related.to"]]),(0,s.createVNode)(p,{"ignore-types":[a.value.type],value:a.value,direction:"to"},null,8,["ignore-types","value"])]),_:1})):(0,s.createCommentVNode)("",!0)]),_:3},16,["class","default-tab","resource","use-hash","onChanged"])}var i=a(63209),l=a(42411),d=a(14220),c=a(65375),u=(0,s.defineComponent)({...c.A,props:{mode:{type:String,default:d.G5},realMode:{type:String,default:d.G5},as:{type:String,default:d.zD},value:{type:Object,required:!0},initialValue:{type:Object,default:null},liveValue:{type:Object,default:null},doneEvent:{type:Boolean,default:!1},useTabbedHash:{type:Boolean,default:void 0}}});function p(e,t,a,r,o,n){const i=(0,s.resolveComponent)("SortableTable");return(0,s.openBlock)(),(0,s.createBlock)(i,{headers:n.headers,rows:n.rows,"key-field":"condition","default-sort-by":"condition","table-actions":!1,"row-actions":!1,search:!1},{"cell:condition":(0,s.withCtx)(({row:e})=>[(0,s.createElementVNode)("span",{class:(0,s.normalizeClass)({"text-error":e.error})},(0,s.toDisplayString)(e.condition),3)]),"cell:status":(0,s.withCtx)(({row:e})=>[(0,s.createElementVNode)("span",{class:(0,s.normalizeClass)({"text-error":e.error})},(0,s.toDisplayString)(e.status),3)]),_:1},8,["headers","rows"])}var h=a(75253),m={components:{SortableTable:h.A},props:{value:{type:Object,default:()=>({})}},computed:{headers(){return[{name:"condition",labelKey:"tableHeaders.condition",value:"condition",width:150,sort:"condition",dashIfEmpty:!0},{name:"status",labelKey:"tableHeaders.status",value:"status",width:75,sort:"status",dashIfEmpty:!0},{name:"time",labelKey:"tableHeaders.updated",value:"time",sort:"time",formatter:"LiveDate",formatterOpts:{addSuffix:!0},width:125,dashIfEmpty:!0},{name:"message",labelKey:"tableHeaders.message",value:"message",sort:["message"],dashIfEmpty:!0}]},rows(){return(this.value.status?.conditions||[]).map(e=>{let t=e.message||"";return e.reason&&(t=`[${e.reason}] ${t}`.trim()),{condition:e.type||"Unknown",status:e.status||"Unknown",error:e.error,time:e.lastProbeTime||e.lastUpdateTime||e.lastTransitionTime,message:t}})}}},g=a(47433);const f=(0,g.A)(m,[["render",p]]);var v=f,b=a(35664),y=a(67055);function w(e,t,a,r,o,n){const i=(0,s.resolveComponent)("BadgeState"),l=(0,s.resolveComponent)("ResourceTable");return(0,s.openBlock)(),(0,s.createBlock)(l,{schema:null,rows:n.rows,headers:n.headers,search:!1,"table-actions":!1,namespaced:!0,"mangle-action-resources":n.getRealResources,"paging-label":"sortableTable.paging.generic",groupable:!1},{"cell:state":(0,s.withCtx)(({row:e})=>[(0,s.createVNode)(i,{value:e},null,8,["value"])]),_:1},8,["rows","headers","mangle-action-resources"])}var S=a(32632),C=a(75648),T=a(68774),$=a(74302),R=a(27278),k=a(41418),B={components:{ResourceTable:S.A,BadgeState:k.j},props:{value:{type:Object,required:!0},rel:{type:String,default:null},direction:{type:String,default:"to"},ignoreTypes:{type:Array,default:()=>[]}},data(){return{loadedResources:1}},computed:{filteredRelationships(){let e=this.value?.metadata?.relationships||[];return e=e.filter(e=>{const t=e[`${this.direction}Type`];return!(!t||this.ignoreTypes.includes(t))&&(!this.rel||e.rel===this.rel)}),e},rows(){if(this.loadedResources<1)return;const e=this.$store.getters["clusterId"],t=this.$store.getters["currentStore"](),a=[];for(const s of this.filteredRelationships){const r=s[`${this.direction}Type`],o=s.state||this.$store.getters[`${t}/byId`](r,s[`${this.direction}Id`])?.state||C.jv.MISSING,n=(0,C.uU)(o,s.error,s.transitioning),i=this.$store.getters[`${t}/schemaFor`](r);let l=s[`${this.direction}Id`];if(!l)continue;let d=null;const c=l.indexOf("/"),u=`${r}/${d}/${l}`;c>0&&(d=l.substr(0,c),l=l.substr(c+1));const p={name:`c-cluster-product-resource${d?"-namespace":""}-id`,params:{product:R.o,cluster:"management"===t?"local":e,resource:r,namespace:d,id:l}};a.push({type:r,id:s[`${this.direction}Id`],state:o,metadata:{namespace:d,name:l},_key:u,name:l,namespace:d,nameDisplay:l,nameSort:(0,$.RY)(l).toLowerCase(),stateColor:n,detailLocation:p,typeDisplay:this.$store.getters["type-map/labelFor"](i),stateDisplay:(0,C.ch)(o),stateBackground:n.replace("text-","bg-"),groupByLabel:d})}return a},headers(){return[T.c4,T.ZE,T.o_,T.CU]}},methods:{async getRealResources(e){const t=this.$store.getters["currentStore"](),a=await Promise.allSettled(e.map(e=>this.$store.dispatch(`${t}/find`,{type:e.type,id:e.id}))),s=[];for(let r=0;r<a.length;r++)"fulfilled"===a[r].status&&s.push(a[r].value);return this.loadedResources++,s}}};const x=(0,g.A)(B,[["render",w]]);var E=x,H=a(50025),N=a(57699),A=a(46392),_=a(44544),I={name:"ResourceTabs",components:{Tabbed:i.A,Tab:l.A,Conditions:v,PaginatedResourceTable:y.A,RelatedResources:E},mixins:[u],props:{value:{type:Object,default:()=>({})},mode:{type:String,default:d.nW},defaultTab:{type:String,default:null},needConditions:{type:Boolean,default:!0},needEvents:{type:Boolean,default:!0},needRelated:{type:Boolean,default:!0},extensionParams:{type:Object,default:null},useHash:{type:Boolean,default:!0}},setup(e){e.mode===d.nW&&(0,_.wi)()},data(){const e=this.$store.getters["currentStore"](b.ll),t=this.$store.getters[`${e}/schemaFor`](b.ll),a=t?[N.ke,N.qI,T.rh,(0,A.UQ)("Subobject",t,this.$store.getters,!0),(0,A.UQ)("Source",t,this.$store.getters,!0),T.w5,N.IZ,(0,A.UQ)("Count",t,this.$store.getters,!0),N.l3]:[];return{eventSchema:t,EVENT:b.ll,selectedTab:this.defaultTab,inStore:e,showConditions:!1,paginationHeaders:a}},beforeUnmount(){this.$store.dispatch("cluster/forgetType",b.ll)},fetch(){this.setShowConditions()},computed:{isNamespace(){return this.value?.type===b.CU},showEvents(){return this.isView&&this.needEvents&&this.eventSchema},showRelated(){return this.isView&&this.needRelated},eventHeaders(){return[{name:"type",label:this.t("tableHeaders.type"),value:"eventType",sort:"eventType"},{name:"reason",label:this.t("tableHeaders.reason"),value:"reason",sort:"reason"},{name:"date",label:this.t("tableHeaders.updated"),value:"date",sort:"date:desc",formatter:"LiveDate",formatterOpts:{addSuffix:!0},width:125},{name:"message",label:this.t("tableHeaders.message"),value:"message",sort:"message"}]},conditionsHaveIssues(){return!!this.showConditions&&this.value.status?.conditions?.filter(e=>!(0,C.rv)(e)).some(e=>e.error)},children(){return this.$slots?.default?.()||[]}},methods:{async setShowConditions(){this.isView&&this.needConditions&&this.value?.type&&this.schema?.fetchResourceFields&&(await this.schema.fetchResourceFields(),this.showConditions=this.$store.getters[`${this.inStore}/pathExistsInSchema`](this.value.type,"status.conditions"))},filterEventsLocal(e){return e.filter(e=>this.isNamespace?e.metadata?.namespace===this.value?.metadata?.name:e.involvedObject?.uid===this.value?.metadata?.uid)},filterEventsApi(e){e.filters||(e.filters=[]);const t=this.isNamespace?"metadata.namespace":"involvedObject.uid",a=this.isNamespace?this.value.metadata.name:this.value.metadata.uid,s=e.filters.find(e=>e.fields.some(e=>e.field===t)),r=H.eY.createSingleField({field:t,exact:!0,value:a,equals:!0});return s?Object.assign(s,r):e.filters.push(r),e}}};a(32184);const P=(0,g.A)(I,[["render",n],["__scopeId","data-v-65888363"]]);var V=P},32184:function(e,t,a){var s=a(22040);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);var r=a(74825).A;r("8369a264",s,!0,{sourceMap:!1,shadowMode:!1})},67055:function(e,t,a){"use strict";a.d(t,{A:function(){return c}});var s=a(9274);function r(e,t,a,r,o,n){const i=(0,s.resolveComponent)("ResourceTable");return(0,s.openBlock)(),(0,s.createElementBlock)("div",null,[(0,s.createVNode)(i,(0,s.mergeProps)({ref:"table"},e.$attrs,{schema:e.schema,rows:e.rows,"alt-loading":e.canPaginate&&!e.isFirstLoad,loading:e.loading,"group-by":e.groupBy,"group-sort":e.groupSort,groupable:e.groupable,groupTooltip:e.groupTooltip,groupOptions:e.groupOptions,"override-in-store":e.overrideInStore,headers:e.safeHeaders,namespaced:e.namespaced,"external-pagination-enabled":e.canPaginate,"external-pagination-result":e.paginationResult,onPaginationChanged:e.paginationChanged}),(0,s.createSlots)({_:2},[(0,s.renderList)(e.$slots,(t,a)=>({name:a,fn:(0,s.withCtx)(t=>[(0,s.renderSlot)(e.$slots,a,(0,s.normalizeProps)((0,s.guardReactiveProps)(t)))])}))]),1040,["schema","rows","alt-loading","loading","group-by","group-sort","groupable","groupTooltip","groupOptions","override-in-store","headers","namespaced","external-pagination-enabled","external-pagination-result","onPaginationChanged"])])}var o=a(72586),n=a(32632),i=(0,s.defineComponent)({name:"PaginatedResourceTable",components:{ResourceTable:n.A},mixins:[o.A],props:{schema:{type:Object,required:!0},headers:{type:Array,default:null},paginationHeaders:{type:Array,default:null},groupTooltip:{type:String,default:"resourceTable.groupBy.namespace"},groupBy:{type:String,default:null},groupSort:{type:String,default:null},groupOptions:{type:Array,default:null},groupable:{type:Boolean,default:null},namespaced:{type:Boolean,default:null},fetchSecondaryResources:{type:Function,default:null},overrideInStore:{type:String,default:void 0},fetchPageSecondaryResources:{type:Function,default:null}},data(){return{resource:this.schema.id}},async fetch(){const e=[this.$fetchType(this.resource,[],this.overrideInStore||this.inStore)];this.fetchSecondaryResources&&e.push(this.fetchSecondaryResources({canPaginate:this.canPaginate})),await Promise.all(e)},computed:{safeHeaders(){const e=this.canPaginate?this.paginationHeaders:this.headers,t=this.$store;return e||t.getters["type-map/headersFor"](this.schema,this.canPaginate)}},methods:{clearSelection(){const e=this.$refs.table;e.clearSelection()}}}),l=a(47433);const d=(0,l.A)(i,[["render",r]]);var c=d}}]);
//# sourceMappingURL=epinio-1.13.2-rc7.umd.min.221.js.map